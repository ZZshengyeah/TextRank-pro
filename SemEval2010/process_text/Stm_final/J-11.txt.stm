trade network with price-set agent larri blume dept. of econom cornel univers, ithaca ny lb19@cs.cornel.edu david easlei dept. of econom cornel univers, ithaca ny dae3@cs.cornel.edu jon kleinberg dept. of comput scienc cornel univers, ithaca ny kleinber@cs.cornel.edu ´eva tardo dept. of comput scienc cornel univers, ithaca ny eva@cs.cornel.edu abstract in a wide rang of market, individu buyer and seller often trade through intermediari, who determin price via strateg  consider. typic, not all buyer and seller have access to the same intermediari, and thei trade at correspondingli differ price that reflect their rel amount of power in the market. we model thi phenomenon us a game in which buyer,  seller, and trader engag in trade on a graph that repres the access each buyer and seller ha to the trader. in thi model, trader set price strateg, and then buyer and seller react to the price thei ar offer. we show that the result game alwai ha a subgam perfect nash equilibrium, and that all equilibria lead to an effici (i.e. social optim) alloc of good. we extend these result to a more gener type of match market, such as on find in the match of job applic and employ. final, we consid how the profit obtain by the trader depend on the  underli graph - roughli, a trader can command a posit profit if and onli if it ha an essenti connect in the network structur, thu provid a graph-theoret basi for quantifi the amount of competit among trader. our work differ from recent studi of how price is affect by network structur through our model of price-set as a strateg activ carri out by a subset of agent in the system, rather than studi price set via competit equilibrium or by a truth mechan. categori and subject descriptor j.4 [social and behavior scienc]: econom gener term econom, theori 1. introduct in a rang of set where market mediat the interact of buyer and seller, on observ sever recur properti:  individu buyer and seller often trade through intermediari, not all buyer and seller have access to the same intermediari, and not all buyer and seller trade at the same price. on exampl of thi set is the trade of agricultur good in develop countri. given inadequ transport network, and poor farmer"  limit access to capit, mani farmer have no altern to trade with middlemen in ineffici local market. a develop countri mai have mani such partial overlap market exist  alongsid modern effici market [2]. financi market provid a differ exampl of a set with these gener characterist. in these market much of the trade between buyer and seller is intermedi by a varieti of agent rang from broker to market maker to electron trade  system. for mani asset there is no on market; trade in a singl asset mai occur simultan on the floor of an exchang, on cross network, on electron exchang, and in market in other  countri. some buyer and seller have access to mani or all of these trade venu; other have access to onli on or a few of them. the price at which the asset trade mai differ across these trade venu. in fact, there is no price as differ trader pai or  receiv differ price. in mani set there is also a gap between the price a buyer pai for an asset, the ask price, and the price a seller receiv for the asset, the bid price. on of the most strike exampl of thi phenomenon occur in the market for foreign  exchang, where there is an interbank market with restrict access and a retail market with much more open access. spread, defin as the differ between bid and ask price, differ significantli across these market, even though the same asset is be trade in the two market. in thi paper, we develop a framework in which such phenomena emerg from a game-theoret model of trade, with buyer, seller, and trader interact on a network. the edg of the network  connect trader to buyer and seller, and thu repres the access that differ market particip have to on anoth. the trader serv as intermediari in a two-stage trade game: thei strateg choos bid and ask price to offer to the seller and buyer thei ar connect to; the seller and buyer then react to the price thei face. thu, the network encod the rel power in the structur posit of the market particip, includ the implicit level of competit among trader. we show that thi game alwai ha a 143 subgam perfect nash equilibrium, and that all equilibria lead to an effici (i.e. social optim) alloc of good. we also  analyz how trader profit depend on the network structur, essenti character in graph-theoret term how a trader"s payoff is  determin by the amount of competit it experi with other trader. our work here is connect to sever line of research in  econom, financ, and algorithm game theori, and we discuss these connect in more detail later in the introduct. at a gener level, our approach can be view as synthes two import strand of work: on that treat buyer-seller interact us  network structur, but without attempt to model the processs by which price ar actual form [1, 4, 5, 6, 8, 9, 10, 13]; and anoth strand in the literatur on market microstructur that  incorpor price-set intermediari, but without network-type constraint on who can trade with whom [12]. by develop a  network model that explicitli includ trader as price-set agent, in a system togeth with buyer and seller, we ar abl to captur price format in a network set as a strateg process carri out by intermediari, rather than as the result of a central  control or exogen mechan. the basic model: indistinguish good. our goal in  formul the model is to express the process of price-set in  market such as those discuss abov, where the particip do not all have uniform access to on anoth. we ar given a set b of buyer, a set s of seller, and a set t of trader. there is an  undirect graph g that indic who is abl to trade with whom. all edg have on end in b ∪ s and the other in t; that is, each edg ha the form (i, t) for i ∈ s and t ∈ t, or (j, t) for j ∈ b and t ∈ t. thi reflect the constraint that all buyer-seller transact go through trader as intermediari. in the most basic version of the model, we consid ident good, on copi of which is initi held by each seller. buyer and seller each have a valu for on copi of the good, and we assum that these valu ar common knowledg. we will subsequ gener thi to a set in which good ar distinguish,  buyer can valu differ good differ, and potenti seller can valu transact with differ buyer differ as well. have differ buyer valuat captur set like hous purchas; ad differ seller valuat as well captur match  market - for exampl, seller as job applic and buyer as  employ, with both care about who end up with which good (and with trader act as servic that broker the job search). thu, to start with the basic model, there is a singl type of good; the good come in individis unit; and each seller initi hold on unit of the good. all three type of agent valu monei at the same rate; and each i ∈ b ∪ s addition valu on copi of the good at θi unit of monei. no agent want more than on copi of the good, so addit copi ar valu at 0. each agent ha an initi endow of monei that is larger than ani individu  valuat θi; the effect of thi is to guarante that ani buyer who end up without a copi of the good ha been price out of the market due to it valuat and network posit, not a lack of fund. we pictur each good that is sold flow along a sequenc of two edg: from a seller to a trader, and then from the trader to a buyer. the particular wai in which good flow is determin by the follow game. first, each trader offer a bid price to each seller it is connect to, and an ask price to each buyer it is connect to. seller and buyer then choos from among the offer present to them by trader. if multipl trader propos the same price to a seller or buyer, then there is no strict best respons for the seller or buyer. in thi case a select must be made, and, as is standard (see for exampl [10]), we (the model) choos among the best offer. final, each trader bui a copi of the good from each seller that accept it offer, and it sell a copi of the good to each buyer that accept it offer. if a particular trader t find that more buyer than seller accept it offer, then it ha commit to provid more copi of the good than it ha receiv, and we will sai that thi result in a larg penalti to the trader for default; the effect of thi is that in equilibrium, no trader will choos bid and ask price that result in a default. more precis, a strategi for each trader t is a specif of a bid price βti for each seller i to which t is connect, and an ask price αtj for each buyer j to which t is connect. (we can also handl a model in which a trader mai choos not to make an offer to certain of it adjac seller or buyer.) each seller or buyer then choos at most on incid edg, indic the trader with whom thei will transact, at the indic price. (the choic of a singl edg reflect the fact that (a) seller each initi have onli on copi of the good, and (b) buyer each onli want on copi of the good.) the payoff ar as follow: for each seller i, the payoff from select trader t is βti, while the payoff from select no trader is θi. (in the former case, the seller receiv βti unit of monei, while in the latter it keep it copi of the good, which it valu at θi.) for each buyer j, the payoff from select trader t is θj −αtj, whle the payoff from select no trader is 0. (in the former case, the buyer receiv the good but give up αtj unit of monei.) for each trader t, with accept offer from seller i1, . . . , is and buyer j1, . . . , jb, the payoff is p r αtjr − p r βtir ,  minu a penalti π if b > s. the penalti is chosen to be larg enough that a trader will never incur it in equilibrium, and henc we will gener not be concern with the penalti. thi defin the basic element of the game. the equilibrium  concept we us is subgam perfect nash equilibrium. some exampl. to help with think about the model, we now describ three illustr exampl, depict in figur 1. to keep the figur from get too clutter, we adopt the follow  convent: seller ar drawn as circl in the leftmost column and will be name i1, i2, . . . from top to bottom; trader ar drawn as squar in the middl column and will be name t1, t2, . . . from top to bottom; and buyer ar drawn as circl in the rightmost column and will be name j1, j2, . . . from top to bottom. all seller in the exampl will have valuat for the good equal to 0; the valuat of each buyer is drawn insid it circl; and the bid or ask price on each edg is drawn on top of the edg. in figur 1(a), we show how a standard second-price auction aris natur from our model. suppos the buyer valuat from top to bottom ar w > x > y > z. the bid and ask price shown ar consist with an equilibrium in which i1 and j1 accept the  offer of trader t1, and no other buyer accept the offer of it adjac trader: thu, trader t1 receiv the good with a bid price of x, and make w − x by sell the good to buyer j1 for w. in thi wai, we can consid thi particular instanc as an auction for a singl good in which the trader act as proxi for their adjac buyer. the buyer with the highest valuat for the good end up with it, and the surplu is divid between the seller and the associ trader. note that on can construct a k-unit auction with > k buyer just as easili, by build a complet bipartit graph on k seller and trader, and then attach each trader to a singl distinct buyer. in figur 1(b), we show how node with differ posit in the network topolog can achiev differ payoff, even when all 144 w x y z x w x x y y z z (a) auction 1 1 1 0 x x 0 1 x x 1 (b) heterogen outcom 1 1 1 0 x x 0 1 x x 1 (c) implicit perfect competit figur 1: (a) an auction, mediat by trader, in which the buyer with the highest valuat for the good end up with it. (b) a network in which the middl seller and buyer benefit from perfect competit between the trader, while the other seller and buyer have no power due to their posit in the network. (c) a form of implicit perfect competit: all bid/ask spread will be zero in equilibrium, even though no trader directli compet with ani other trader for the same buyer-seller pair. buyer valuat ar the same numer. specif, seller i2 and buyer j2 occupi power posit, becaus the two trader ar compet for their busi; on the other hand, the other seller and buyer ar in weak posit, becaus thei each have onli on option. and inde, in everi equilibrium, there is a real number x ∈ [0, 1] such that both trader offer bid and ask price of x to i2 and j2 respect, while thei offer bid of 0 and ask of 1 to the other seller and buyer. thu, thi exampl illustr a few crucial ingredi that we will identifi at a more gener level shortli. specif, i2 and j2 experi the benefit of perfect competit, in that the two trader drive the bid-ask spread to 0 in compet for their busi. on the other hand, the other seller and buyer experi the downsid of monopoli - thei receiv 0 payoff sinc thei have onli a singl option for trade, and the correspond trader make all the profit. note further how thi natur behavior emerg from the fact that trader ar abl to offer differ price to differ agent - captur the fact that there is no on fix price in the kind of market that motiv the model, but rather differ price reflect the rel power of the differ agent involv. the previou exampl show perhap the most natur wai in which a trader"s profit on a particular transact can drop to 0: when there is anoth trader who can replic it function  precis. (in that exampl, two trader each had the abil to move a copi of the good from i2 to j2.) but as our subsequ result will show, trader make zero profit more gener due to global, graph-theoret reason. the exampl in figur 1(c) give an initi indic of thi: on can show that for everi equilibrium, there is a y ∈ [0, 1] such that everi bid and everi ask price is equal to y. in other word, all trader make zero profit, whether or not a copi of the good pass through them - and yet, no two trader have ani seller-buyer path in common. the price spread have been driven to zero by a global constraint impos by the long cycl through all the agent; thi is an exampl of implicit perfect competit determin by the network topolog. extend the model to distinguish good. we extend the basic model to a set with distinguish good, as follow.  instead of have each agent i ∈ b ∪ s have a singl numer valuat θi, we index valuat by pair of buyer and seller: if buyer j obtain the good initi held by seller i, it get a util of θji, and if seller i sell it good to buyer j, it experi a loss of util of θij . thi gener the case of indistinguish good, sinc we can alwai have these pairwis valuat depend onli on on of the indic. a strategi for a trader now consist of offer a bid to each seller that specifi both a price and a buyer, and  offer an ask to each buyer that specifi both a price and a seller. (we can also handl a model in which a trader offer bid  (respect, ask) in the form of vector, essenti specifi a menu with a price attach to each buyer (resp. seller).) each buyer and seller select an offer from an adjac trader, and the payoff to all agent ar determin as befor. thi gener framework captur match market [10, 13]: for exampl, a job market that is mediat by agent or employ search servic (as in hire for corpor execut, or sport or entertain figur). here the seller ar job applic, buyer ar employ, and trader ar the agent that mediat the job  market. of cours, if on specifi pairwis valuat on buyer but just singl valuat for seller, we model a set where buyer can distinguish among the good, but seller don"t care whom thei sell to - thi (roughli) captur set like hous market. our result. our result will identifi gener form of some of the principl note in the exampl discuss abov - includ the question of which buyer end up with the good; the question of how payoff ar differ realiz by seller, trader, and  buyer; and the question of what structur properti of the network determin whether the trader will make posit profit. to make these precis, we introduc the follow notat. ani outcom of the game determin a final alloc of good to some of the agent; thi can be specifi by a collect m of tripl (ie, te, je), where ie ∈ s, te ∈ t, and je ∈ b; moreov, each seller and each buyer appear in at most on tripl. the mean is for each e ∈ m, the good initi held by ie move to je through te. (seller appear in no tripl keep their copi of the good.) we sai that the valu of the alloc is equal to p e∈m θjeie − θiej . let θ∗ denot the maximum valu of ani alloc m that is feasibl given the network. we show that everi instanc of our game ha an equilibrium, and that in everi such equilibrium, the alloc ha valu θ∗  145 in other word, it achiev the best valu possibl. thu,  equilibria in thi model ar alwai effici, in that the market enabl the right set of peopl to get the good, subject to the network  constraint. we establish the exist and effici of equilibria by construct a linear program to captur the flow of good through the network; the dual of thi linear program contain enough  inform to extract equilibrium price. by the definit of the game, the valu of the equilibrium  alloc is divid up as payoff to the agent, and it is interest to ask how thi valu is distribut - in particular how much profit a trader is abl to make base on it posit in the network. we find that, although all equilibria have the same valu, a given trader"s payoff can vari across differ equilibria. howev, we ar abl to character the maximum and minimum amount that a given trader is abl to make, where these maxima and minima ar taken over all equilibria, and we give an effici algorithm to comput thi. in particular, our result here impli a clean combinatori character of when a given trader t can achiev non-zero  payoff: thi occur if and onli there is some edg e incid to t that is essenti, in the sens that delet e reduc the valu of the  optim alloc θ∗ . we also obtain result for the sum of all trader profit. relat work. the standard baselin approach for analyz the interact of buyer and seller is the walrasian model in which anonym buyer and seller trade a good at a singl market  clear price. thi reduc form of trade, built on the ideal of a market price, is a power model which ha led to mani insight. but it is not a good model to us to examin where price come from or exactli how buyer and seller and trade with each other. the difficulti is that in the walrasian model there is no agent who set the price, and agent don"t actual trade with each other. in fact there is no market, in the everydai sens of that word, in the walrasian model. that is, there is no physic or virtual place where buyer and seller interact to trade and set price. thu in thi simpl model, all buyer and seller ar uniform and trade at the same price, and there is also no role for intermediari. there ar sever literatur in econom and financ which  examin how price ar set rather than just determin equilibrium price. the literatur on imperfect competit is perhap the  oldest of these. here a monopolist, or a group of oliogopolist, choos price in order to maxim their profit (see [14] for the standard textbook treatment of these market). a monopolist us it  knowledg of market demand to choos a price, or a collect of price if it discrimin. oliogopolist plai a game in which their  payoff depend on market demand and the action of their competitor. in thi literatur there ar agent who set price, but the fiction of a singl market is maintain. in the equilibrium search literatur, firm set price and consum search over them (see [3]).  consum do end up pai differ price, but all consum have access to all firm and there ar no intermediari. in the gener equilibrium literatur there have been variou attempt to introduc price determin. a standard proof techniqu for the exist of competit equilibrium involv a price adjust mechan in which price respond to excess demand. the walrasian  auction is often introduc as a devic to explain how thi process work, but thi is a fundament a metaphor for an iter  priceupd algorithm, not for the intern of an actual market. more sophist process have been introduc to studi the  stabil of equilibrium price or the inform necessari to comput them. but again there ar no price-set agent here. in the financ literatur the work on market microstructur doe have price-set agent (specialist), part of it do determin  separ bid and ask price, and differ agent receiv differ price for the same asset (see [12] for a treatment of microstructur  theori). work in inform econom ha identifi similar  phenomena (see e.g. [7]). but there is littl research in these literatur examin the effect of restrict on who can trade with whom. there have been sever approach to studi how network structur determin price. these have posit price determin through definit base on competit equilibrium or the core, or through the us of truth mechan. in briefli review thi work, we will note the contrast with our approach, in that we model price as aris from the strateg behavior of agent in the system. in recent work, kakad et al. [8] have studi the distribut of price at competit equilibrium in a bipartit graph on buyer and seller, gener us a probabilist model capabl of produc heavi-tail degre distribut [11]. even-dar et al. [6] build on thi to consid the strateg aspect of network format when price aris from competit equilibrium. leonard [10], babaioff et al. [1], and chu and shen [4] consid an approach base on mechan design: buyer and seller resid at differ node in a graph, and thei incur a given  transport cost to trade with on anoth. leonard studi vcg price in thi set; babaioff et al. and chu and shen addition provid a a budget-balanc mechan. sinc the concern here is with truth mechan that oper on privat valuat, there is an inher trade-off between the effici of the alloc and the budget-balanc condit. in contrast, our model ha known valuat and price aris from the strateg behavior of trader. thu, the assumpt  behind our model ar in a sens not directli compar to those  underli the mechan design approach: while we assum known valuat, we do not requir a central author to impos a mechan. rather, price-set is part of the strateg outcom, as in the real market that motiv our work, and our equilibria ar simultan budget-balanc and effici - someth not possibl in the mechan design framework that have been us. demang, gale, and sotomayor [5], and kranton and minehart [9], analyz the price at which trade occur in a network, work within the framework of mechan design. kranton and minehart us a bipartit graph with direct link between buyer and seller, and then us an ascend auction mechan, rather than strateg intermediari, to determin the price. their auction ha desir equilibrium properti but as kranton and minehart note it is an abstract of how good ar alloc and price ar determin that is similar in spirit to the walrasian auction abstract. in fact, we can show how the basic model of kranton and minehart can be encod as an instanc of our game, with trader produc price at equilibrium match the price produc by their auction mechan.1 final, the classic result of shaplei and shubik [13] on the assign game can be view as studi the result of trade on a bipartit graph in term of the core. thei studi the dual of a linear program base on the match problem, similar to what we us for a reduc version of our model in the next section, but their focu is differ as thei do not consid agent that seek to set price. 2. market with pair-trader for understand the idea behind the analysi of the gener model, it is veri us to first consid a special case with a  re1 kranton and minehart, howev, can also analyz a more  gener set in which buyer valu ar privat and thu buyer and seller plai a game of incomplet inform. we deal onli with complet inform. 146 strict form of trader that we refer to as pair-trader. in thi case, each trader is connect to just on buyer and on seller. (thu, it essenti serv as a trade rout between the two.) the  techniqu we develop to handl thi case will form a us basi for reason about the case of trader that mai be connect  arbitrarili to the seller and buyer. we will relat profit in a subgam perfect nash equilibrium to optim solut of a certain linear program, us thi relat to show that all equilibria result in effici alloc of the good, and show that a pure equilibrium alwai exist. first, we consid the simplest model where seller have indistinguish item, and each buyer is interest in get on item. then we extend the result to the more gener case of a match market, as discuss in the previou section, where valuat depend on the ident of the seller and buyer. we then character the minimum and maximum profit trader can make. in the next section, we extend the result to trader that mai be connect to ani subset of seller and buyer. given that we ar work with pair-trader in thi section, we can repres the problem us a bipartit graph g whose node set is b ∪ s, and where each trader t, connect seller i and buyer j, appear as an edg t = (i, j) in g. note, howev, that we allow multipl trader to connect the same pair of agent. for each buyer and seller i, we will us adj(i) to denot the set of trader who can trade with i. 2.1 indistinguish good the social optim trade for the case of indistinguish good is the solut of the transport problem: send good along the edg repres the trader. the edg along which trade occur correspond to a match in thi bipartit graph, and the optim trade is describ by the follow linear program. max sv (x) = x t∈t :t=(i,j) xt(θj − θi) xt ≥ 0 ∀t ∈ t x t∈adj(i) xt ≤ 1 ∀i ∈ s x t∈adj(j) xt ≤ 1 ∀j ∈ b next we consid an equilibrium. each trader t = (i, j) must offer a bid βt and an ask αt. (we omit the subscript denot the seller and buyer here sinc we ar deal with pair-trader.) given the bid and ask price, the agent react to these price, as describ earlier. instead of focus on price, we will focu on profit. if a seller i sell to a trader t ∈ adj(i) with bid βt then hi profit is pi = βt − θi. similarli, if a buyer j bui from a trader t ∈ adj(j) with ask αt, then hi profit is pj = θj − αt. final, if a trader t trade with ask αt and bid βt then hi profit is yt = αt − βt. all agent not involv in trade make 0 profit. we will show that the profit at equilibrium ar an optim solut to the follow linear program. min sum(p, y) = x i∈b∪s pi + x t∈t yt yt ≥ 0 ∀t ∈ t : pi ≥ 0 ∀i ∈ s ∪ b : yt ≥ (θj − pj) − (θi + pi) ∀t = (i, j) ∈ t lemma 2.1. at equilibrium the profit must satisfi the abov inequ. proof. clearli all profit ar nonneg, as trade is option for all agent. to see why the last set of inequ hold, consid two case separ. for a trader t who conduct trade, we get equal by definit. for other trader t = (i, j), the valu pi +θi is the price that seller i sold for (or θi if seller i decid to keep the good). offer a bid βt > pi + θi would get the seller to sell to trader t. similarli, θj − pj is the price that buyer j bought for (or θj if he didn"t bui), and for ani ask αt < θj − pj, the buyer will bui from trader t. so unless θj − pj ≤ θi + pi the trader ha a profit deviat. now we ar readi to prove our first theorem: theorem 2.2. in ani equilibrium the trade is effici. proof. let x be a flow of good result in an equilibrium, and let variabl p and y be the profit. consid the linear program describ the social optim trade. we will also add a set of addit constraint xt ≤ 1 for all trader t ∈ t; thi can be ad to the descript, as it is impli by the other constraint. now we claim that the two linear program ar dual of each other. the variabl pi for agent b ∪ s correspond to the equat p t∈adj(i) xt ≤ 1. the addit dual variabl yt correspond to an addit inequ xt ≤ 1. the optim of the social valu of the trade will follow from the claim that the solut of these two linear program deriv from an equilibrium satisfi the complementari slack  condit for thi pair of linear program, and henc both x and (p, y) ar optim solut to the correspond linear program. there ar three differ complementari slack condit we need to consid, correspond to the three set of variabl x, y and p. ani agent can onli make profit if he transact, so pi > 0 impli p t∈adj(i) xt = 1, and similarli, yt > 0 impli that xt = 1 also. final, consid a trader t with xt > 0 that trade between seller i and buyer j, and recal that we have seen abov that the inequ yt ≥ (θj − pj) − (θi + pi) is satisfi with equal for those who trade. next we argu that equilibria alwai exist. theorem 2.3. for ani effici trade between buyer and  seller there is a pure equilibrium of bid-ask valu that support thi trade. proof. consid an effici trade; let xt = 1 if t trade and 0 otherwis; and consid an optim solut (p, y) to the dual linear program. we would like to claim that all dual solut correspond to  equilibrium price, but unfortun thi is not exactli true. befor we can convert a dual solut to equilibrium price, we mai need to modifi the solut slightli as follow. consid ani agent i that is onli connect to a singl trader t. becaus the agent is onli connect to a singl trader, the variabl yt and pi ar dual  variabl correspond to the same primal inequ xt ≤ 1, and thei alwai appear togeth as yt + pi in all inequ, and also in the object function. thu there is an optim solut in which pi = 0 for all agent i connect onli to a singl trader. assum (p, y) is a dual solut where agent connect onli to on trader have pi = 0. for a seller i, let βt = θi + pi be the bid for all trader t adjac to i. similarli, for each buyer j, let αt = θj − pj be the ask for all trader t adjac to j. we claim that thi set of bid and ask, togeth with the trade x, ar an equilibrium. to see why, note that all trader t adjac to a seller or buyer i offer the same ask or bid, and so trade with ani trader is equal good for agent i. also, if i is not trade in the solut 147 x then by complementari slack pi = 0, and henc not trade is also equal good for i. thi show that seller and buyer don"t have an incent to deviat. we need to show that trader have no incent to deviat either. when a trader t is trade with seller i and buyer j, then profit deviat would involv increas αt or decreas βt. but by our construct (and assumpt about monopol agent) all seller and buyer have multipl ident ask/bid offer, or trade is occur at valuat. in either case such a deviat cannot be success. final, consid a trader t = (i, j) who doesn"t trade. a  deviat for t would involv offer a lower ask to seller i and a higher bid to seller j than their current trade. howev, yt = 0 by complementari slack, and henc pi + θi ≥ θj − pj, so i sell for a price at least as high as the price at which j bui, so trader t cannot creat profit trade. note that a seller or buyer i connect to a singl trader t cannot have profit at equilibrium, so possibl equilibrium profit ar in on-to-on correspond with dual solut for which pi = 0 whenev i is monopol by on trader. a disappoint featur of the equilibrium creat by thi proof is that some agent t mai have to creat ask-bid pair where βt > αt, offer to bui for more than the price at which thei ar will to sell. agent that make such cross bid-ask pair never actual perform a trade, so it doe not result in neg profit for the agent, but such pair ar unnatur. cross bid-ask pair ar weakli domin by the strategi of offer a low bid β = 0 and an extrem high ask to guarante that neither is accept. to formul a wai of avoid such cross pair, we sai an equilibrium is cross-free if αt ≥ βt for all trader t. we now show there is alwai a cross-free equilibrium. theorem 2.4. for ani effici trade between buyer and  seller there is a pure cross-free equilibrium. proof. consid an optim solut to the dual linear program. to get an equilibrium without cross bid, we need to do a more gener modif than just assum that pi = 0 for all seller and buyer connect to onli a singl trader. let the set e be the set of edg t = (i, j) that ar tight, in the sens that we have the equal yt = (θj − pj) − (θi + pi). thi set e contain all the edg where trade occur, and some more edg. we want to make sure that pi = 0 for all seller and buyer that have degre at most 1 in e. consid a seller i that ha pi > 0. we must have i involv in a trade, and the edg t = (i, j) along which the trade occur must be tight. suppos thi is the onli tight edg adjac to agent i; then we can decreas pi and increas yt till on of the follow happen: either pi = 0 or the constraint of some other agent t ∈ adj(i) becom tight. thi chang onli increas the set of tight edg e, keep the solut feasibl, and doe not chang the object function valu. so after do thi for all seller, and analog chang yt and pj for all buyer, we get an optim solut where all seller and buyer i either have pi = 0 or have at least two adjac tight edg. now we can set ask and bid to form a cross-free equilibrium. for all trader t = (i, j) associ with an edg t ∈ e we set αt and βt as befor: we set the bid βt = pi + θi and the ask αt = θj −pj. for a trader t = (i, j) ∈ e we have that pi +θi > θj −pj and we set αt = βt to be ani valu in the rang [θj − pj, pi + θi]. thi guarante that for each seller or buyer the best sell or bui offer is along the edg where trade occur in the solut. the  askbid valu along the tight edg guarante that trader who trade cannot increas their spread. trader t = (i, j) who do not trade cannot make profit due to the constraint pi + θi ≥ θj − pj 1 1 1 0 0 1 0 1 1 0 0 0 1 (a) no trader profit 1 1 1 0 x x x x 1 x x 0 x (b) trader profit figur 2: left: an equilibrium with cross bid where trader make no monei. right: an equilibrium without cross bid for ani valu x ∈ [0, 1]. total trader profit rang between 1 and 2. 2.2 distinguish good we now consid the case of distinguish good. as in the previou section, we can write a transship linear program for the social optim trade, with the onli chang be in the  object function. max sv (x) = x t∈t :t=(i,j) xt(θji − θij) we can show that the dual of thi linear program correspond to trader profit. recal that we need to add the constraint xt ≤ 1 for all trader. the dual is then: min sum(p, y) = x i∈b∪s pi + x t∈t yt yt ≥ 0 ∀t ∈ t : pi ≥ 0 ∀i ∈ s ∪ b : yt ≥ (θji − pj) − (θij + pi) ∀t = (i, j) ∈ t it is not hard to extend the proof of theorem 2.2 - 2.4 to thi case. profit in an equilibrium satisfi the dual constraint, and profit and trade satisfi complementari slack. thi show that trade is social optim. take an optim dual solut where pi = 0 for all agent that ar monopol, we can convert it to an equilibrium, and with a bit more care, we can also creat an equilibrium with no cross bid-ask pair. theorem 2.5. all equilibria for the case of pair-trader with distinguish good result in social optim trade. pure  noncross equilibria exist. 2.3 trader profit we have seen that all equilibria ar effici. howev, it turn out that equilibria mai differ in how the valu of the alloc is spread between the seller, buyer and trader. figur 2 depict a simpl exampl of thi phenomenon. our goal is to understand how a trader"s profit is affect by it posit in the network; we will us the character we  obtain to work out the rang of profit a trader can make. to  maxim the profit of a trader t (or a subset of trader t ) all we need to do is to find an optim solut to the dual linear program  maxim the valu of yt (or the sum p t∈t yt). such dual solut will then correspond to equilibria with non-cross price. 148 theorem 2.6. for ani trader t or subset of trader t the maximum total profit thei can make in ani equilibrium can be  comput in polynomi time. thi maximum profit can be obtain by a non-cross equilibrium. on wai to think about the profit of a trader t = (i, j) is as a subtract from the valu of the correspond edg (i, j). the valu of the edg is the social valu θji − θij if the trader make no profit, and decreas to θji − θij − yt if the trader t insist on make yt profit. trader t get yt profit in equilibrium, if after thi decreas in the valu of the edg, the edg is still includ in the optim transship. theorem 2.7. a trader t can make profit in an equilibrium if and onli if t is essenti for the social welfar, that is, if delet agent t decreas social welfar. the maximum profit he can make is exactli hi valu to societi, that is, the increas hi presenc caus in the social welfar. if we allow cross equilibria, then we can also find the  minimum possibl profit. recal that in the proof of theorem 2.3, trader onli made monei off of seller or buyer that thei have a monopoli over. allow such equilibria with cross bid we can find the minimum profit a trader or set of trader can make, by minim the valu yt (or sum p t∈t yt) over all optim  solut that satisfi pi = 0 whenev i is connect to onli a singl trader. theorem 2.8. for ani trader t or subset of trader t the minimum total profit thei can make in ani equilibrium can be  comput in polynomi time. 3. gener trader next we extend the result to a model where trader mai be  connect to an arbitrari number of seller and buyer. for a trader t ∈ t we will us s(t) and b(t) to denot the set of buyer and seller connect to trader t. in thi section we focu on the gener case when good ar distinguish (i.e. both buyer and seller have valuat that ar sensit to the ident of the agent thei ar pair with in the alloc). in the full version of the paper we also discuss the special case of indistinguish good in more detail. to get the optim trade, we consid the bipartit graph g = (s ∪ b, e) connect seller and buyer where an edg e = (i, j) connect a seller i and a buyer j if there is a trader adjac to both: e = {(i, j) : adj(i) ∩ adj(j) = ∅}. on thi graph, we then solv the instanc of the assign problem that wa also us in section 2.2, with the valu of edg (i, j) equal to θji − θij (sinc the valu of trade between i and j is independ of which trader conduct the trade). we will also us the dual of thi linear program: min val(z) = x i∈b∪s zi zi ≥ 0 ∀i ∈ s ∪ b. zi + zj ≥ θji − θij ∀i ∈ s, j ∈ b : adj(i) ∩ adj(j) = ∅. 3.1 bid and ask and trader optim first we need to understand what bid model we will us. even when good ar indistinguish, a trader mai want to  pricediscrimin, and offer differ bid and ask valu to differ  seller and buyer. in the case of distinguish good, we have to deal with a further complic: the trader ha to name the good she is propos to sell or bui, and can possibl offer multipl differ product. there ar two variant of our model depend whether a trader make a singl bid or ask to a seller or buyer, or she offer a menu of option. (i) a trader t can offer a buyer j a menu of ask αtji, a vector of valu for all the product that she is connect to, where αtji is the ask for the product of seller i. symmetr, a trader t can offer to each seller i a menu of bid βtij for sell to differ buyer j. (ii) altern, we can requir that each trader t can make at most on ask to each seller and on bid for each buyer, and an ask ha to includ the product sold, and a bid ha to offer a particular buyer to sell to. our result hold in either model. for notat simplic we will us the menu option here. next we need to understand the optim problem of a trader t. suppos we have bid and ask valu for all other trader t ∈ t, t = t. what ar the best bid and ask offer trader t can make as a best respons to the current set of bid and ask? for each seller i let pi be the maximum profit seller i can make us bid by other trader, and symmetr assum pj is the maximum profit buyer j can make us ask by other trader (let pi = 0 for ani seller or buyer i who cannot make profit). now consid a seller-buyer pair (i, j) that trader t can connect. trader t will have to make a bid of at least βtij = θij +pi to seller i and an ask of at most αtji = θji −pj to buyer j to get thi trade, so the maximum profit she can make on thi trade is vtij = αtji − βtij = θji − pj − (θij + pi). the optim trade for trader t is obtain by solv a match problem to find the match between the seller s(t) and buyer b(t) that maxim the total valu vtij for trader t. we will need the dual of the linear program of find the trade of maximum profit for the trader t. we will us qti as the dual variabl associ with the constraint of seller or buyer i. the dual is then the follow problem. min val(qt) = x i∈b(t)∪s(t) qti qti ≥ 0 ∀i ∈ s(t) ∪ b(t). qti + qtj ≥ vtij ∀i ∈ s(t), j ∈ b(t). we view qti as the profit made by t from trade with seller or buyer i. theorem 3.1 summar the abov discuss. theorem 3.1. for a trader t, given the lowest bid βtij and highest ask αtji that can be accept for seller i ∈ s(t) and buyer j ∈ b(t), the best trade t can make is the maximum valu match between s(t) and b(t) with valu vtij = αtji − βtij for the edg (i, j). thi maximum valu is equal to the minimum of the dual linear program abov. 3.2 effici trade and equilibrium now we can prove trade at equilibrium is alwai effici. theorem 3.2. everi equilibrium result in an effici  alloc of the good. proof. consid an equilibrium, with xe = 1 if and onli if trade occur along edg e = (i, j). trade is a solut to the  transship linear program us in section 2.2. let pi denot the profit of seller or buyer i. each trader t  current ha the best solut to hi own optim problem. a trader t find hi optim trade (given bid and ask by all other 149 trader) by solv a match problem. let qti for i ∈ b(t)∪s(t) denot the optim dual solut to thi match problem as  describ by theorem 3.1. when set up the optim problem for a trader t abov, we us pi to denot the maximum profit i can make without the offer of trader t. note that thi pi is exactli the same pi we us here, the profit of agent i. thi is clearli true for all trader t that ar not trade with i in the equilibrium. to see why it is true for the trader t that i is trade with we us that the current set of bid-ask valu is an equilibrium. if for ani agent i the bid or ask of trader t were the uniqu best option, then t could extract more profit by offer a bit larger ask or a bit smaller bid, a contradict. we show the trade x is optim by consid the dual solut zi = pi + p t qti for all agent i ∈ b ∪ s. we claim z is a dual solut, and it satisfi complementari slack with trade x. to see thi we need to show a few fact. we need that zi > 0 impli that i trade. if zi > 0 then either pi > 0 or qti > 0 for some trader t. agent i can onli make profit pi > 0 if he is involv in a trade. if qti > 0 for some t, then trader t must trade with i, as hi solut is optim, and by complementari slack for the dual solut, qti > 0 impli that t trade with i. for an edg (i, j) associ with a trader t we need to show the dual solut is feasibl, that is zi + zj ≥ θji − θij . recal vtij = θji −pj −(θij +pi), and the dual constraint of the trader"s optim problem requir qti + qtj ≥ vtij. put these togeth, we have zi + zj ≥ pi + qti + pj + qtj ≥ vtij + pi + pj = θji − θij . final, we need to show that the trade variabl x also  satisfi the complementari slack constraint: when xe > 0 for an edg e = (i, j) then the correspond dual constraint is tight. let t be the trader involv in the trade. by  complementari slack of t"s optim problem we have qti + qtj = vtij. to see that z satisfi complementari  slack we need to argu that for all other trader t = t we have both qt i = 0 and qt j = 0. thi is true as qt i > 0 impli by complementari slack of t "s optim problem that t must trade with i at optimum, and t = t is trade. next we want to show that a non-cross equilibrium alwai exist. we call an equilibrium non-cross if the bid-ask offer a trader t make for a seller-buyer pair (i, j) never cross, that is βtij ≤ αtji for all t, i, j. theorem 3.3. there exist a non-cross equilibrium  support ani social optim trade. proof. consid an optim trade x and a dual solut z as befor. to find a non-cross equilibrium we need to divid the profit zi between i and the trader t trade with i. we will us qti as the trader t"s profit associ with agent i for ani i ∈ s(t) ∪ b(t). we will need to guarante the follow properti: trader t trade with agent i whenev qti > 0. thi is on of the complementari slack condit to make sure the current trade is optim for trader t. for all seller-buyer pair (i, j) that a trader t can trade with, we have pi + qti + pj + qtj ≥ θji − θij , (1) which will make sure that qt is a feasibl dual solut for the optim problem face by trader t. we need to have equal in (1) when trader t is trade  between i and j. thi is on of the complementari slack condit for trader t, and will ensur that the trade of t is optim for the trader. final, we want to arrang that each agent i with pi > 0 ha multipl offer for make profit pi, and the trade occur at on of hi best offer. to guarante thi in the correspond bid and ask we need to make sure that whenev pi > 0 there ar multipl t ∈ adj(i) that have equat in the abov constraint (1). we start by set pi = zi for all i ∈ s ∪ b and qti = 0 for all i ∈ s ∪ b and trader t ∈ adj(i). thi guarante all invari except the last properti about multipl t ∈ adj(t) have equal in (1). we will modifi p and q to gradual enforc the last condit, while maintain the other. consid a seller with pi > 0. by optim of the trade and dual solut z, seller i must trade with some trader t, and that trader will have equal in (1) for the buyer j that he match with i. if thi is the onli trader t that ha a tight constraint in (1)  involv seller i then we increas qti and decreas pi till either pi = 0 or anoth trader t = t will be achiev equal in (1) for some buyer edg adjac to i (possibl a differ buyer j ). thi chang  maintain all invari, and increas the set of seller that also satisfi the last constraint. we can do a similar chang for a buyer j that ha pj > 0 and ha onli on trader t with a tight constraint (1)  adjac to j. after possibl repeat thi for all seller and buyer, we get profit satisfi all constraint. now we get equilibrium bid and ask valu as follow. for a trader t that ha equal for the seller-buyer pair (i, j) in (1) we offer αtji = θji − pj and βtij = θij + pi. for all other trader t and seller-buyer pair (i, j) we have the invari (1), and us thi we know we can pick a valu γ in the rang θij +pi+qti ≥ γ ≥ θji − (pj + qtj ). we offer bid and ask valu βtij = αtji = γ. neither the bid nor the ask will be the uniqu best offer for the buyer, and henc the trade x remain an equilibrium. 3.3 trader profit final we turn to the goal of understand, in the case of  gener trader, how a trader"s profit is affect by it posit in the network. first, we show how to maxim the total profit of a set of trader. the profit of trader t in an equilibrium is p i qti. to find the maximum possibl profit for a trader t or a set of trader t , we need to do the follow: find profit pi ≥ 0 and qti > 0 so that zi = pi + p t∈adj(i) qti is an optim dual solut, and also satisfi the constraint (1) for ani seller i and buyer j connect through a trader t ∈ t. now, subject to all these condit, we maxim the sum p t∈t p i∈s(t)∪b(t) qti. note that thi  maxim is a secondari object function to the primari object that z is an optim dual solut. then we us the proof of  theorem 3.3 show how to turn thi into an equilibrium. theorem 3.4. the maximum valu for p t∈t p i qti abov is the maximum profit the set t of trader can make. proof. by the proof of theorem 3.2 the profit of trader t can be written in thi form, so the set of trader t cannot make more profit than claim in thi theorem. to see that t can inde make thi much profit, we us the proof of theorem 3.3. we modifi that proof to start with profit vector p and qt for t ∈ t , and set qt = 0 for all trader t ∈ t . we verifi that thi start solut satisfi the first three of the four requir properti, and then we can follow the proof to make the fourth properti true. we omit the detail of thi in the present version. in section 2.3 we show that in the case of pair trader, a trader t can make monei if he is essenti for effici trade. thi is not 150 1 1 figur 3: the top trader is essenti for social welfar. yet the onli equilibrium is to have bid and ask valu equal to 0, and the trader make no profit. true for the type of more gener trader we consid here, as shown by the exampl in figur 3. howev, we still get a character for when a trader t can make a posit profit. theorem 3.5. a trader t can make profit in an equilibrium if and onli if there is a seller or buyer i adjac to t such that the connect of trader t to agent i is essenti for social  welfarethat is, if delet agent t from adj(i) decreas the valu of the optim alloc. proof. first we show the direct that if a trader t can make monei there must be an agent i so that t"s connect to i is essenti to  social welfar. let p, q be the profit in an equilibrium where t make monei, as describ by theorem 3.2 with p i∈s(t)∪b(t) qti > 0. so we have some agent i with qti > 0. we claim that the  connect between agent i and trader t must be essenti, in particular, we claim that social welfar must decreas by at least qti if we delet t from adj(t). to see why note that decreas the valu of all edg of the form (i, j) associ with trader t by qti keep the same trade optimum, as we get a match dual solut by simpli reset qti to zero. to see the opposit, assum delet t from adj(t) decreas social welfar by some valu γ. assum i is a seller (the case of buyer is symmetr), and decreas by γ the social valu of each edg (i, j) for ani buyer j such that t is the onli agent connect i and j. by assumpt the trade is still optim, and we let z be the dual solut for thi match. now we us the same process as in the proof of theorem 3.3 to creat a non-cross equilibrium start with pi = zi for all i ∈ s ∪b, and qti = γ, and all other q valu 0. thi creat an equilibrium with non-cross bid where t make at least γ profit (due to trade with seller i). final, if we allow cross equilibria, then we can find the  minimum possibl profit by simpli find a dual solut  minim the dual variabl associ with agent monopol by some trader. theorem 3.6. for ani trader t or subset of trader t , the minimum total profit thei can make in ani equilibrium can be  comput in polynomi time. 4. refer [1] m. babaioff, n. nisan, e. pavlov. mechan for a spatial distribut market. acm ec confer, 2005. [2] c. barrett, e. mutambatser. agricultur market in develop countri. the new palgrav dictionari of econom, 2nd edit, forthcom. [3] kenneth burdett and kenneth judd. equilibrium price disperison. econometrica, 51/4, juli 1983, 955-969. [4] l. chu, z.-j. shen. agent competit doubl auction mechan. manag scienc, 52/8, 2006. [5] g. demang, d. gale, m. sotomayor. multi-item auction. j. polit econ. 94(1986). [6] e. even-dar, m. kearn, s. suri. a network format game for bipartit exchang economi. acm-siam symp. on discret algorithm (soda), 2007. [7] j. kephart, j. hanson, a. greenwald. dynam price by softwar agent. comput network, 2000. [8] s. kakad, m. kearn, l. ortiz, r. pemantl, s. suri. econom properti of social network. nip 2004. [9] r. kranton, d. minehart. a theori of buyer-seller network. american econom review 91(3), june 2001. [10] h. leonard. elicit of honest prefer for the assign of individu to posit. j. pol. econ, 1983. [11] m. e. j. newman. the structur and function of complex network. siam review, 45:167-256, 2003. [12] m. o"hara. market microstructur theori. blackwel publish, cambridg, ma, 1995. [13] l. shaplei m. shubik, the assign game i: the core. intl. j. game theori 1/2 111-130, 1972. [14] jean tirol. the theori of industri organ. the mit press, cambridg, ma, 1988. 151 