research on scheme of pairwis kei establish for distributedsensor network wang lei fujian univers technolog fuzhou,funjian, pr.china (+)86-591-8755-9001, 350014 wanglei_hn@hn165.com chen zhi-ping fujian univers technolog fuzhou,funjian, pr.china (+)86-591-8755-9001, 350014 jt_zpchen@hnu.cn jiang xin-hua fujian univers technolog fuzhou,funjian, pr.china (+)86-591-8755-9001, 350014 xhj@csu.edu.cn abstract secur scheme of pairwis kei establish, which enabl sensor to commun with each other secur, plai a fundament role in research on secur issu in wireless sensor network. a new kind of cluster deploi sensor network distribut model is present, and base on which, an innov hierarch hypercub model - h(k,u,m,v,n) and the map relationship between cluster deploi sensor network and the h(k,u,m,v,n) ar propos. by util nice properti of h(k,u,m,v,n) model, a new gener framework for pairwis kei predistribut and a new pairwis kei establish algorithm ar design, which combin the idea of kdc(kei distribut center) and polynomi pool scheme. furthermor, the work perform of the newli propos pairwis kei establish algorithm is serious inspect. theoret analysi and experiment figur show that the new algorithm ha better perform and provid higher possibl for sensor to establish pairwis kei, compar with previou relat work. categori and subject descriptor c.2.4 [comput-commun-network]: distribut system-distribut applic. gener term: secur. 1. introduct secur commun is an import requir in mani sensor network applic, so share secret kei ar us between commun node to encrypt data. as on of the most fundament secur servic, pairwis kei establish enabl the sensor node to commun secur with each other us cryptograph techniqu. howev, due to the sensor node' limit comput capabl, batteri energi, and avail memori, it is not feasibl for them to us tradit pairwis kei establish techniqu such as public kei cryptographi and kei distribut center (kdc). sever altern approach have been develop recent to perform pairwis kei establish on resourc-constrain sensor network without involv the us of tradit cryptographi  [14]. eschenau and gligor propos a basic probabilist kei  predistribut scheme for pairwis kei establish [1]. in the scheme, each sensor node randomli pick a set of kei from a kei pool befor the deploy so that ani two of the sensor node have a certain probabl to share at least on common kei. chan et al. further extend thi idea and present two kei  predistribut scheme: a q-composit kei pre-distribut scheme and a random pairwis kei scheme. the q-composit scheme requir ani two sensor share at least q pre-distribut kei. the random scheme randomli pick pair of sensor and assign each pair a uniqu random kei [2]. inspir by the studi abov and the polynomi-base kei pre-distribut protocol [3], liu et al. further develop the idea address in the previou work and propos a gener framework of polynomi pool-base kei  predistribut [4]. the basic idea can be consid as the combin of the polynomi-base kei pre-distribut and the kei pool idea us in [1]] and [2]. base on such a framework, thei present two pairwis kei pre-distribut scheme: a random subset assign scheme and a grid-base scheme. a polynomi pool is us in those scheme, instead of us a kei pool in the previou techniqu. the random subset assign scheme assign each sensor node the secret gener from a random subset of polynomi in the polynomi pool. the  gridbas scheme associ polynomi with the row and the column of an artifici grid, assign each sensor node to a uniqu coordin in the grid, and give the node the secret gener from the correspond row and column polynomi. base on thi grid, each sensor node can then identifi whether it can directli establish a pairwis kei with anoth node, and if not, what intermedi node it can contact to indirectli establish the pairwis kei. a similar approach to those scheme describ by liu et al wa independ develop by du et a. [5]. rather than on blundo's scheme their approach is base on blom's scheme [6]. in some case, it is essenti equival to the on in [4]. all of those scheme abov improv the secur over the basic probabilist kei pre-distribut scheme. howev, the pairwis kei establish problem in sensor network is still not well solv. for the basic probabilist and the q-composit kei  predistribut scheme, as the number of compromis node increas, the fraction of affect pairwis kei increas quickli. as a result, a small number of compromis node mai affect a larg fraction of pairwis kei [3]. though the random pairwis kei scheme dose not suffer from the abov secur problem, it incur a high memori overhead, which increas linearli with the number of node in the network if the level of secur is kept constant [2][4]. for the random subset assign scheme, it suffer higher commun and comput overhead. in 2004, liu propos a new hypercub-base pairwis kei predistribut scheme [7], which extend the grid-base scheme from a two dimension grid to a multi-dimension hypercub. the analysi show that hypercub-base scheme keep some attract properti of the grid-base scheme, includ the guarante of establish pairwis kei and the resili to node compromis. also, when perfect secur against node compromis is requir, the hypercub-base scheme can support a larger network by ad more dimens instead of increas the storag overhead on sensor node. though hypercub-base scheme (we consid the grid-base scheme is a special case of hypercub-base scheme) ha mani attract properti, it requir ani two node in sensor network can commun directli with each other. thi strong assumpt is impract in most of the actual applic of the sensor network. in thi paper, we present a kind of new cluster-base distribut model of sensor network, and for which, we propos a new pairwis kei pre-distribut scheme. the main contribut of thi paper ar as follow: combin the deploy knowledg of sensor network and the polynomi pool-base kei pre-distribut, we setup a  clusterbas topolog that is practic with the real deploy of sensor network. base on the topolog, we propos a novel cluster distribut base hierarch hypercub model to establish the pairwis kei. the kei contribut is that our scheme dose not requir the assumpt of all node can directli commun with each other as the previou scheme do, and it still maintain high probabl of kei establish, low memori overhead and good secur perform. we develop a kind of new pairwis kei establish algorithm with our hierarch hypercub model. the structur of thi paper is arrang as follow: in section 3, a new distribut model of cluster deploi sensor network is present. in section 4, a new hierarch hypercub model is propos. in section 5, the map relationship between the cluster deploi sensor network and hierarch hypercub model is discuss. in section 6 and section 7, new pairwis kei establish algorithm ar design base on the hierarch hypercub model and detail analys ar describ. final, section 8 present a conclus. 2. preliminari definit 1 (kei predistribut): the procedur, which is us to encod the correspond encrypt and decrypt algorithm in sensor node befor distribut, is call kei predistribut. definit 2 (pairwis kei): for ani two node a and b, if thei have a common kei e, then the kei e is call a pairwis kei between them. definit 3 (kei path): for ani two node a0 and ak, when there ha not a pairwis kei between them, if there exist a path a0,a1,a2,……,ak-1,ak, and there exist at least on pairwis kei between the node ai and aj for 0≤i≤k-1 and 1≤j≤k, then the path consist of a0,a1,a2,……,ak-1,ak is call a kei path between a0 and ak. definit 4 (n-dimension hypercub): an n-dimension hypercub (or n−cube) h(v,n) is a topolog with the follow properti: (1) it is consist of n·vn-1 edg, (2) each node can be code as a string with n posit such as b1b2…bn, where 0≤b1,b2,…,bn≤v-1, (3) ani two node ar call neighbor, which mean that there is an edg between them, iff there is just on posit differ between their node code. 3. model of cluster deploi sensor network in some actual applic of sensor network, sensor can be deploi through airplan. suppos that the deploy round of sensor ar k, and the commun radiu of ani sensor is r, then the sensor deploi in the same round can be regard as belong to a same cluster. we assign a uniqu cluster number l (1 ≤ l ≤ k) for each cluster. suppos that the sensor form a connect graph in ani cluster after deploy through airplan, and then the fig.1 present an actual model of cluster deploi sensor network. figur.1 an actual model of cluster deploi sensor network. from figur.1, it is easi to know that, for a given node a, there exist lot of node in the same cluster of a, which can be commun directli with a, sinc the node ar deploi dens in a cluster. but there exist much less node in a cluster neighbor to the cluster of a, which can be commun directli with a. sinc the two cluster ar not deploi at the same time. 4. hierarch hypercub model definit 5 (k-level hierarch hypercub): let there ar n node total, then a k-level hierarch hypercub name h(k,u,m,v,n) can be construct as follow: 1) the n node ar divid into k cluster averag, and the [n/k] node in ani cluster ar connect into an n-dimension hypercub: in the n-dimension hypercub, ani node is encod 55 as i1i2…in, which ar call in-cluster-hypercub-node-code, where 0 ≤ i1,i2,…in ≤ v-1,v=[ n kn / ],[j] equal to an integ not less than j. so we can obtain k such kind of differ hypercub. 2) the k differ hypercub obtain abov ar encod as j1j2…jm, which ar call out-cluster-hypercub-node-code, where 0 ≤ j1,j2,…jm ≤ u-1,u=[ m k ]. and the node in the k differ hypercub ar connect into m-dimension hypercub accord to the follow rule: the node with same in-cluster-hypercub-node-code and differ  out-clusterhypercub-node-code ar connect into an m-dimension hypercub. (the graph construct through abov step is call a k-level hierarch hypercub abbrevi as h(k,u,m,v,n).) 3) ani node a in h(k,u,m,v,n) can be encod as (i, j), where i(i=i1i2…in, 0 ≤ i1,i2,…in ≤ v-1) is the  in-cluster-hypercubenod-code of node a, and j(j=j1j2…jm, 0 ≤ j1,j2,…jm ≤ u-1) is the out-cluster-hypercub-node-code of node a. obvious, the h(k,u,m,v,n) model ha the follow good properti: properti 1: the diamet of h(k,u,m,v,n) model is m+n. proof: sinc the diamet of n-dimension hypercub is n, and the diamet of m-dimension hypercub is m, so it is easi to know that the diamet of h(k,u,m,v,n) model is m+n from the definit 5. properti 2: the distanc between ani two node a(i1, j1) and b(i2, j2) in h(k,u,m,v,n) model is d(a,b)= dh(i1, i2)+dh(j1, j2), where dh repres the ham distanc. proof: sinc the distanc between ani two node in hypercub equal to the ham distanc between them, so it is obviou that the theorem 2"s conclus stand from definit 5. 5. map cluster deploi sensor network to h(k,u,m,v,n) obvious, from the descript in section 3 and 4, we can know that the cluster deploi sensor network can be map into a  klevel- hierarch hypercub model as follow: at first, the k cluster in the sensor network can be map into k differ level (or hypercub) in the k-level- hierarch hypercub model. then, the sensor node in each cluster can be encod with the in-cluster-hypercub-node-code, and the sensor node in the k differ cluster with the same  in-clusterhypercub-node-code can be encod with the  out-clusterhypercub-node-code accord to the definit 5 respect. consequ, the whole sensor network ha been map into a k-level- hierarch hypercub model. 6. h(k,u,m,v,n) model-base pairwis kei predistribut algorithm for sensor network in order to overcom the drawback of polynomi-base and polynomi pool-base kei predistribut algorithm, thi paper propos an innov h(k,u,m,v,n) model-base kei predistribut scheme and pairwis kei establish algorithm, which combin the advantag of polynomi-base and kei pool-base encrypt scheme, and is base on the kdc and polynomi pool-base kei predistribut model. the new h(k,u,m,v,n) model-base pairwis kei establish algorithm includ three main step: (1) gener of the polynomi pool and kei predistribut, (2) direct pairwis kei discoveri, (3) path kei discoveri. 6.1 gener of polynomi pool and kei predistribut suppos that, the sensor network includ n node, and is deploi through k differ round. then we can predistribut kei for each sensor node on the basi of the h(k,u,m,v,n) model as follow: step 1: kei setup server randomli gener a bivari polynomi pool such as the follow: f={ f i iiil n >< −121 ,...,,, (x,y), f j jjjinii m >< −121 ,...,,,,...,2,1 (x,y) | 0 ≤ iii n 121 ... −≤≤≤ ≤ v-1, 1 ≤ i ≤ n, 1 ≤ l ≤ k; 0 ≤ jjj m 121 ... −≤≤≤ ≤ u-1 , 1 ≤ j ≤ m} with vn *m*um-1 +[n/vn ]*n*vn-1 differ t-degre bivari polynomi over a finit field fq, and then assign a uniqu polynomi id to each bivari polynomi in f. step 2: in each round, kei setup server assign a uniqu node id: (i1i2…in,j1j2…jm) to each sensor node from small to big, where 0 ≤ i1,i2,…in ≤ v-1, 0 ≤ j1,j2,…jm ≤ u-1. step 3: kei setup server assign a uniqu cluster id: l to all the sensor node deploi in the same round, where 1 ≤ l ≤ k. step 4: kei setup server predistribut m+n bivari polynomi { f iiil n 1 ,...,,, 32 >< (i1,y),…, f n iiil n >< −121 ,...,,, (in,y); f jjinii m 1 ,...,,,...,2,1 2 >< ( j1,y),…, f m jjinii m >< −11 ,...,,,...,2,1 ( jm,y) } and the correspond polynomi id to the sensor node deploi in the lth round and with id (i1i2…in, j1j2…jm). 6.2 direct pairwis kei discoveri if the node a(i1i2…in,j1j2…jm) in the sensor network want to establish pairwis kei with a node b (i'1i'2…i'n,j'1j'2…j'm), then node a can establish pairwis kei with the node b trough the follow method. firstli, node a comput out the distanc between itself and node b: d= d1+ d2, where d1=dh(i1i2…in, i'1i'2…i'n) and d2=dh(j1j2…jm, j'1j'2…j'm). if d=1, then node a obtain the direct pairwis kei between itself and node b accord to the follow theorem 1: theorem 1: for ani two sensor node a(i1i2…in,j1j2…jm) and b (i'1i'2…i'n,j'1j'2…j'm) in the sensor network, suppos that the 56 distanc between node a and b is d= d1+ d2, where d1=dh(i1i2…in, i'1i'2…i'n) and d2=dh(j1j2…jm, j'1j'2…j'm). if d=1, then there exist a direct pairwis kei between node a and b. poof: sinc d=1, then there is d1=1, d2=0, or d1=0, d2=1. 1) if d1=1, d2=0: from d2=0, there is node a, b belong to the same cluster. suppos that node a, b belong to the same cluster l, then from d1=1 ⇒ there is onli on posit differ between i1i2…in and i"1i"2…i"n. let it=i"t, when 1 ≤ t ≤ n-1, and in ≠ i"n ⇒ f n iiil n >< −121 ,...,,, (in,i"n)= f n iiil n >′′′< −121 ,...,,, (i"n,in). so, there exist a direct pairwis kei f n iiil n >< −121 ,...,,, (in,i"n) between node a and b. 2) if d1=0, d2=1: from d2=1 ⇒ there is onli on posit differ between j1j2…jm and j"1j"2…j"m. let jt=j"t, when 1 ≤ t ≤  m1, and jm ≠ j"m. sinc d1=0 ⇒ i1i2…in equal to i"1i"2…i"n ⇒ f m jjjinii m >< −121 ,...,,,,...,2,1 (jm, j"m)= f m jjji nii m >′′′′′′< −121 ,...,,,,...,2,1 (j"m,jm). so, there exist a direct pairwis kei f m jjjinii m >< −121 ,...,,,,...,2,1 (jm, j"m) between node a and b. accord to theorem 1, we present the detail descript of the direct pairwis kei discoveri algorithm as follow: step 1: obtain the node id and cluster id of the sourc node a and destin node b; step 2: comput out the distanc between node a and b: d= d1+ d2; step 3: if d1=1, d2=0, then select out a common polynomi share of node a and b from { f iiil n 1 ,...,,, 32 >< ,..., f n iiil n >< −121 ,...,,, } to establish direct pairwis kei; step 4: if d1=0, d2=1, then select out a common polynomi share of node a and b from { f jjinii m 1 ,...,,,...,2,1 2 >< ,..., f m jjjinii m >< −121 ,...,,,,...,2,1 } to establish direct pairwis kei; step 5: otherwis, there exist no direct pairwis kei between node a and b. and then turn to the follow path kei discoveri process. 6.3 path kei discoveri if d>1, then node a can establish path kei with node b accord to the follow theorem 2: theorem 2: for ani two sensor node a(i1i2…in,j1j2…jm) and b (i'1i'2…i'n,j'1j'2…j'm) in the sensor network, suppos that the distanc between node a and b is d= d1+ d2, where d1=dh(i1i2…in, i'1i'2…i'n) and d2=dh(j1j2…jm, j'1j'2…j'm). if d>1, then there exist a path kei between node a and b. proof: let d1=a, d2=b, then we can think that it ≠ i't, when 1 ≤ t ≤ a; but it=i't, when t>a; and jt ≠ j't, when 1 ≤ t ≤ b; but jt=j't, when t>b. obvious, node a(i1i2…in, j1j2…jm) ,(i'1i2 i3…in, j1j2…jm),(i'1i'2 i3…in, j1j2…jm),…,(i'1i'2…i'n, j1j2…jm) belong to the same cluster. so, accord to the suppos condit of the node in the same cluster form a connect graph, there is a rout among those node. in addit, in those node, the distanc between ani two neighbor node is 1, so from theorem 1, it is easi to know that there exist direct pairwis kei between ani two neighbor node among those node. for node (i'1i'2…i'n,j1j2…jm), (i'1i'2…i'n,j'1 j2 j3…jm), (i'1i'2…i'n,j'1j'2 j3…jm-1 jm),…, (i'1i'2…i'n,j'1j'2…j'm-1jm), sinc thei have the same out-cluster-hypercub-node-code with the node b(i'1i'2…i'n,j'1j'2…j'm), so node (i'1i'2…i'n,j1j2…jm), (i'1i'2…i'n,j'1 j2 j3…jm), (i'1i'2…i'n,j'1j'2 j3…jm-1 jm),…, (i'1i'2…i'n,j'1j'2…j'm-1 jm) and node b belong to a same logic hypercub. obvious, from the suppos condit of the whole sensor network form a connect graph, there is a rout among those node. in addit, in those node, the distanc between ani two neighbor node is 1, so from theorem 1, it is easi to know that there exist direct pairwis kei between ani two neighbor node among those node. so, it is obviou that there exist a path kei between node a and b. accord to theorem 2, we present the detail descript of the path kei discoveri algorithm as follow: step 1: comput out the intermedi node (i'1i2 i3…in,j1j2…jm), (i'1i'2 i3…in,j1j2…jm),…,(i'1i'2…i'n, j1j2…jm) and (i'1i'2…i'n,j1'j2 j3…jm), (i'1i'2…i'n,j'1j'2 j3…j'm-1 jm),…,(i'1i'2…i'n,j'1j'2…j'm-1 jm) from the sourc node a(i1i2…in,j1j2…jm) and the destin node b (i'1i'2…i'n,j'1j'2…j'm). step 2: in those node seri a(i1i2…in,j1j2…jm), (i'1i2 i3…in,j1j2…jm), (i'1i'2 i3…in,j1j2…jm),…,(i'1i'2…i'n,j1j2…jm) and (i'1i'2…i'n,j1'j2 j3…jm), (i'1i'2…i'n,j'1j'2 j3…j'm-1 jm),…, (i'1i'2…i'n, j'1j'2…j'm-1 jm), b (i'1i'2…i'n,j'1j'2…j'm), the neighbor node select their common polynomi share to establish direct pairwis kei. from theorem 2, it is easi to know that ani sourc node a can comput out a kei path p to the destin node b accord to the abov algorithm, when there ar no compromis node in the sensor network. onc the kei path p is comput out, then node a can send messag to b along the path p to establish indirect pairwis kei with node b. fig.2 present a exampl of kei path establish. figur.2 kei path establish exampl. for exampl: in the abov figur.2, node a((012),(1234)) can establish pairwis kei with node b((121),(2334)) through the follow kei path: a((012),(1234)) → c((112),(1234)) → d((122),(1234)) → e((121),(1234)) → f((121),(2234)) → b((121),(2334)), where node f shall rout through node g, h, i, j to establish direct pairwis kei with node b. 57 accord to the properti of h(k,u,m,v,n) model, we can prove that the follow theorem by comb the proof of theorem 2: theorem 3: suppos that there exist no compromis node in the sensor network, and the distanc between node a and b, then there exist a shortest kei path with k distanc between node a and b logic. that is to sai, node a can establish indirect pairwis kei with node b through t-1 intermedi node. proof: suppos that the distanc between node a(i1i2…in, j1j2…jm) and b (i'1i'2…i'n, j'1j'2…j'm) is d=d1+ d2, where d1=dh(i1i2…in, i'1i'2…i'n), d2=dh(j1j2…jm, j'1j'2…j'm). sinc d=t, accord to the construct properti of h(k,u,m,v,n), it is easi to know that there exist t-1 intermedi node i1,…,it-1, in the logic space h(k,u,m,v,n), which satisfi that the distanc between ani two neighbor node in the node seri a,  i1,…,it1, b equal to 1. so accord to the theorem 1, we can know that node a, i1,…,it-1, b form a correct kei path between node a and b. if ani two neighbor node in the node seri a, i1,…,it-1, b can commun directli, then node a can establish indirect pairwis kei with node b through those t-1 intermedi node. 6.4 dynam path kei discoveri the path kei discoveri algorithm propos in the abov section can establish a kei path correctli, onli when there exist no compromis node in the whole sensor network, sinc the kei path is comput out beforehand. and the propos algorithm cannot find an altern kei path when there exist some compromis node or some intermedi node not in the commun radiu, even that there exist other altern kei path in the sensor network. from the follow exampl we can know that there ar mani parallel path in the h(k,u,m,v,n) model for ani two given sourc and destin node, sinc the h(k,u,m,v,n) model is high fault-toler[9,10] . figur.3 altern kei path establish exampl. for exampl: consid the kei path establish exampl given in the abov section base on figur.2: a((012),(1234)) → c((112),(1234)) → d((122),(1234)) → e((121),(1234)) → f((121),(2234)) → b((121),(2334)), suppos that node f((121),(2234)) ha compromis, then from figur.3, we can know that there exist anoth altern kei path as a((012),(1234)) → c((112),(1234)) → d((122),(1234)) →e((121),(1234)) → m((121),(1334)) → b((121),(2334)), which can be us to establish the indirect pairwis kei between node a and b, where node e shall rout through node d and k to establish direct pairwis kei with node m, and node m shall rout through node n, o, g, h, i, j to establish direct pairwis kei with node b. sinc the sensor ar sourc limit, so thei ar easi to die or out of the commun radiu, therefor the algorithm propos in the abov section cannot guarante to establish correct kei path effici. in thi section, we will propos a dynam path kei discoveri algorithm as follow, which can improv the probabl of kei path effect: algorithm i: dynam kei path establish algorithm base on h(k,u,m,v,n) model for cluster deploi sensor network. input: sub-sensor network h(k,u,m,v,n), which ha some compromis /fault sensor and fault link, and two reachabl node a(a1…an,a"1…a"m) and b(b1…bn,b"1…b"m) in h(k,u,m,v,n), where a"t ≠ b"t, t∈[1,s], a"t=b"t, t >s. output: a correct kei path from node a to b in h(k,u,m,v,n). step 1: obtain the code string of node a and b: a ← (a1…an,a"1…a"m), b ← (b1…bn,b"1…b"m), where aj, bj [0,∈ u-1], a"j, b"j [0,∈ v-1]. step 2: if a"1…a"m = b"1…b"m, then node a can find a rout to b accord to the rout algorithm of hypercub [9-10]. step 3: otherwis, node a can find a rout to c(b1…bn, a"1…a"m) accord to the algorithm i or algorithm ii. then let i0=c(b1…bn,a"1…a"m), i1=(b1…bn,b"1 a"2…a"m),…, is=b(b1…bn,b"1 b"2…b"s a"s+1…a"m), and each node it in the abov node seri find a rout to it neighbor node it+1 on the basi of the locat inform (detail rout algorithm base on locat inform can see the refer[11-14]). step 4: algorithm exit. if such kind of a correct kei path exist, then through which node a can establish an indirect pairwis kei with node b. otherwis, node a fail to establish an indirect pairwis kei with node b. and node a will tri again to establish an indirect pairwis kei with node b some time later. 7. algorithm analys 7.1 practic analys accord to the former descript and analys, it is easi to know that the abov newli propos algorithm ha the follow properti: properti 3: when there exist no fault and compromis node, by us new pairwis kei predistribut scheme base on h(k,u,m,v,n) model, the probabl of direct pairwis kei establish between ani two node can be estim as p=(m(u-1)+n(v-1))/(n-1), where n is the total number of node in the sensor network, and n=um * vn . proof: sinc the predistribut pairwis kei for ani node fa ={ f iiil n 1 ,...,,, 32 >< (i1,y),…, f n iiil n >< −121 ,...,,, (in,y); f jjinii m 1 ,...,,,...,2,1 2 >< (j1 ,y),…, f m jjinii m >< −11 ,...,,,...,2,1 ( jm,y) } in the newli propos algorithm. obvious, in the logic hypercub form by the node in the same cluster of node a, there ar n(v-1) node, which 58 have direct pairwis kei with node a. and in the logic hypercub form by the node in differ cluster from that of node a, there ar m(u-1) node, which have direct pairwis kei with node a. therefor, there ar total m(u-1)+n(v-1) node, which have direct pairwis kei with node a. so, the probabl of pairwis kei establish between ani two node can be estim as p=(m(u-1)+n(v-1))/(n-1), sinc the whole sensor network ha n sensor node in all. figur.4 present the comparis between the probabl of direct pairwis kei establish between ani two node and the dimens n, when the sensor network ha differ total node, and us the new pairwis kei predistribut scheme base on h(8,2,3,v,n) model. 2 3 4 5 6 7 8 9 10 0 0.002 0.004 0.006 0.008 0.01 number of dimens probabilitytoestablishdirectkei n = 8000 n=10000 n=20000 n=30000 figur.4 comparis between the probabl of direct pairwis kei establish between ani two node and the dimens n, when the sensor network ha differ total node, and us the new pairwis kei predistribut scheme base on h(8,2,3,v,n) model. from figur.4, it is easi to know that by us new pairwis kei predistribut scheme base on h(k,u,m,v,n) model, the probabl of direct pairwis kei establish between ani two node decreas with the increas of the scale of the sensor network, and in addit, the probabl of direct pairwis kei establish between ani two node decreas with the increas of the dimens n, when the scale of the sensor network is fix. theorem 4: suppos that the total sensor is n in the sensor network, then when u ≥ v2 , the probabl of direct pairwis kei establish between ani two node, when us the kei distribut scheme base on the hypercub model h(v,p), is smaller than that when us the kei distribut scheme base on the h(k,u,m,v,n) model. proof: sinc u ≥ v, then we can let u=vt , where t ≥ 2. sinc the total number of node in h(v,p) is vp =n, the total number of node in h(k,u,m,v,n) is um * vn =n. let p=x+n, then there is um *vn = vx * vn ⇒ um =vx ⇒ x=tm. from the properti 3, it is easi to know that the probabl of direct pairwis kei establish between ani two node can be estim as p=(m(u-1)+n(v-1))/(n-1). accord to the descript in [7], it is well know that the probabl of direct pairwis kei establish between ani two node can be estim as p"= p(v-1)/(n-1)= (x(v-1)+n(v-1))/(n-1). next, we will prove that m(u-1) ≥ x(v-1): m(u-1)= m(vt -1), x(v-1)= tm(v-1). construct a function as f(t)= vt -1- t(v-1), where t ≥ 2. when t=2, it is obviou that there is f(t)= vt -2v+1=( v-1)2 ≥ 0 and f"(t)=t vt-1 - v+1 ≥ 2v- v+1= v+1>0. so, there is f(t) ≥ 0 ⇒ vt -1 ≥ t(v-1) ⇒ m(vt -1) ≥ tm(v-1) ⇒  m(u1) ≥ x(v-1). therefor, the conclus of the theorem stand. as for the conclus of theorem 4, we give an exampl to illustr. suppos that the total number of node in the sensor network is n=214 , and h(k,u,m,v,n)=h(16,4,2,2,10), h(v,p)= h(10,14), then the probabl of direct pairwis kei establish between ani two node base on the h(k,u,m,v,n) model is p=  (m(u-1)+n(v1))/(n-1)= (2(4-1)+10(2-1))/(214 -1)=16/(214 -1), but the probabl of direct pairwis kei establish between ani two node base on the h(v,p) model is p"= p(v-1)/(n-1)=14(2-1)/(214 -1)= 14/(214  1). suppos that the total number of node in the sensor network is n, figur.5 illustr the comparison between the probabl of direct pairwis kei establish between ani two node base on the h(k,u,m,v,n) model and the probabl of direct pairwis kei establish between ani two node base on the h(v,p) model, when u=4 and v=2. 1 2 3 4 5 6 7 8 9 10 0 0.5 1 1.5 x 10 -3 scaleofthesensornetwork probabilitytoestablishdirectkei h(k,u,m,v,n)model-base h(v,p)model-base figur.5 comparison between the probabl of direct pairwis kei establish between h(v,n) and h(k,u,m,v,n) model. from figur.5, it is easi to know that the theorem 5 stand. theorem 5: suppos that the total sensor is n in the sensor network, then the pairwis kei distribut scheme base on the hypercub model h(v,p), is onli a special case of the pairwis kei distribut scheme base on the h(k,u,m,v,n) model. proof: as for the pairwis kei distribut scheme base on the h(k,u,m,v,n) model, let k=1 (u=1, m=0), which mean that the total sensor network includ onli on cluster. then obvious, the h(k,u,m,v,n) model will degrad into the h(v,n) model. accord to the former anays in thi paper and the definit of the pairwis kei distribut scheme base on the hypercub model h(v,p) in [7], it is easi to know that the conclus of the theorem stand. 59 7.2 secur analys by us the pairwis kei establish algorithm base on the h(k,u,m,v,n) model, the intrud can launch two kind of attack: 1) the attack mai target the pairwis kei between two particular sensor node, in order to compromis the pairwis kei between them, or prevent them to establish pairwis kei. 2) the attack mai attack against the whole sensor network, inord to decreas the probabl of the pairwis kei establish, or increas the cost of the pairwis kei establish. attack against a pair of sensor node 1. suppos that the intrud want to attack two particular sensor node u,v, where u,v ar all not compromis node, but the intrud want to compromis the pairwis kei between them. 1) if u,v can establish direct pairwis kei, then the onli wai to compromis the kei is to compromis the common bivari polynomi f(x,y) between u,v. sinc the degre of the bivari polynomi f(x,y) is t, so the intrud need to compromis at least t+1 sensor node that have a share of the bivari polynomi f(x,y). 2) if u,v can establish indirect pairwis kei through intermedi node, then the intrud need to compromis at least on intermedi node, or compromis the common bivari polynomi f(x,y) between two neighbor intermedi node. but even if the intrud succe to do that, node u and v can still  reestablish indirect pairwis kei through altern intermedi node. 2. suppos that the intrud want to attack two particular sensor node u,v, where u,v ar all not compromis node, but the intrud want to prevent them to establish the pairwis kei. then, the intrud need to compromis all of the m+n bivari polynomi of node u or v. sinc the degre of the bivari polynomi f(x,y) is t, so for bivari polynomi, the intrud need to compromis at least t+1 sensor node that have a share of the given bivari polynomi. therefor, the intrud need to compromis (m+n)(t+1) sensor node altogeth to prevent u,v to establish the pairwis kei. attack against the sensor network suppos that the attack know the distribut of the polynomi over sensor node, it mai systemat attack the network by compromis the polynomi in f on by on in order to compromis the entir network. assum the fraction of the compromis polynomi is pc, then there ar up to n"=pc × { vn v n umv n n mn ××+×× ][ }= pc ××n (m+n) sensor node that have at least on compromis polynomi share. among all of the remain n- n" sensor node, none of them includ a compromis polynomi share. so, the remain n- n" sensor node can establish direct pairwis kei by us ani on of their polynomi share. howev, the indirect pairwis kei in the remain n- n" sensor node mai be affect. and thei mai need to re-establish a new indirect pairwis kei between them by select altern intermedi node that do not belong to the n" compromis node. suppos that the scale of the sensor network is n=10000, figur.6 present the comparison between pc and the number of sensor node with at least on compromis polynomi share in sensor network base on differ h(k,u,m,v,n) distribut model. from figur.6, it is easi to know that, when the scale of the sensor network is fix, the number of the affect sensor node in the sensor network increas with the increas of the number of compromis node. 0 0.02 0.04 0.06 0.08 0.1 0.12 0.14 0.16 0 1000 2000 3000 4000 5000 6000 7000 8000 f rac tion of c om prom is ed b ivari p oli nom ialssensornodeswithatleastonecompromisedpolynomialshar h (1,0,0,100,2) h (2,2,1,71,2) h (4,2,2,50,2) h (8,2,3,36,2) figur.6 the comparison between pc and the number of sensor node with at least on compromis polynomi share in sensor network base on differ h(k,u,m,v,n) distribut model. theorem 6: suppos that the total sensor is n in the sensor network, and the fraction of compromis node is pc, then when u>v, the number of affect node of the h(v,p) model base kei predistribut scheme, is bigger than that of the h(k,u,m,v,n) model base kei predistribut scheme. proof: sinc the number of affect node of the h(k,u,m,v,n) model base kei predistribut scheme is pc ××n (m+n), and it is prove in [7] that the number of affect node of the h(v,p) model base kei predistribut scheme is pc ××n p. let p=x+n, then there is um * vn = vx * vn ⇒ um =vx . sinc u>v ⇒ x>m ⇒ pc ××n (m+n)< pc ××n (x+n)= pc ××n p. suppos that the scale of the sensor network is n=10000, figur.7 present the comparison between pc and the number of sensor node with at least on compromis polynomi share in sensor network base on h(9,3,2,2,n) and h(2,p) distribut model. from figur.7, it is easi to know that the conclus of theorem 9 is correct, and the number of the affect sensor node in the sensor network increas with the increas of the number of compromis node, when the scale of the sensor network is fix. 60 0.01 0.02 0.03 0.04 0.05 0.06 0.07 0.08 0.09 0.1 0.11 0 1000 2000 3000 4000 5000 6000 7000 8000 9000 10000 fraction of compromis bivari polynomi sensornodeswithatleastonecompromisedpolynomialshar h(9,3,2,34,2) h(16,4,2,25,2) h(225,15,2,7,2) h(1296,36,2,3,2) h(2,14) figur.7 the comparison between pc and the number of sensor node with at least on compromis polynomi share in sensor network base on h(9,3,2,2,n) and h(2,p) distribut model. 8. conclus a new hierarch hypercub model name h(k,u,m,v,n) is propos, which can be us for pairwis kei predistribut for cluster deploi sensor network. and base on the h(k,u,m,v,n) model, an innov pairwis kei predistribut scheme and algorithm ar design respect, by comb the good properti of the polynomi kei and kei pool encrypt scheme. the new algorithm us the good characterist of node code and high fault-toler of h(k,u,m,v,n) model to rout and predistribut pairwis kei, in which node ar not need to be abl to commun with each other directli such as that the algorithm propos by [7] shall need. so, the tradit pairwis kei predistribut algorithm base on hypercub model [7] is onli a special case of the new algorithm propos in thi paper. theoret and experiment analys show that the newli propos algorithm is an effici pairwis kei establish algorithm that is suitabl for the cluster deploi sensor network. 9. acknowledg our thank to acm sigchi for allow us to modifi templat thei had develop, and to natur scienc fund of fujian provinc of pr.china under grant no.a0510024. 10. refer [1] l. eschenau and v. gligor. a kei-manag scheme for distribut sensor network. in proceed of the 9th acm confer on comput and commun secur. acm press, washington dc, usa, 2002, 41-47. [2] h. chan, a. perrig, and d. song. random kei predistribut scheme for sensor network. in ieee symposium on secur and privaci. ieee comput societi, california, usa, 2003, 197-213. [3] c. blundo, a. d. santi, a. herzberg, s. kutten, u. vaccaro, and m. yung. perfectli-secur kei distribut for dynam confer. lectur note in comput scienc. 1993, 740, 471-486. [4] d. liu and p. ning. establish pairwis kei in distribut sensor network. in proceed of the 10th acm confer on comput and commun secur. acm press, washingt, dc, usa, 2003, 52-61. [5] w. du, j. deng, y. han, and p. varshnei. a pairwis kei pre-distribut scheme for wireless sensor network. in proceed of the tenth acm confer on comput and commun secur. washingt, dc, usa,2003,  4251. [6] r. blom. an optim class of symmetr kei gener system. advanc in cryptolog: proceed of eurocrypt 84. lectur note in comput scienc. 1985, 209, :335-338. [7] donggang liu, peng ning, rongfang li, establish pairwis kei in distribut sensor network. acm journal name, 2004, 20, 1-35. [8] l. fang, w. du, and n. peng. a beacon-less locat discoveri scheme for wireless sensor network, infocom 2005. [9] wang lei, lin ya-ping, maximum safeti path matrix base fault-toler rout algorithm for hypercub interconnect network. journal of softwar. 2004,15(7), 994-1004. [10] wang lei, lin ya-ping, maximum safeti path vector base fault-toler rout algorithm for hypercub interconnect network. journal of china institut of commun. 2004, 16(4), 130-137. [11] lin ya-ping, wang lei, locat inform base hierarch data congreg rout algorithm for sensor network. chines journal of electron. 2004, 32(11), 1801-1805. [12] w. heinzelman, j. kulik, and h. balakrishnan, negoti base protocol for dissemin inform in wireless sensor network. acm wireless network. 2002, 8,  169185. [13] manjeshwar,a.; agraw,d.p. teen: a rout protocol for enhanc effici in wireless sensor network]. in proceed of 15th parallel and distribut process symposium]. ieee comput societi, san francisco, usa, 2001, 2009-2015. [14] b. krishnamachari, d. estrin, and s. wicker. model data-centric rout in wireless sensor network. in proceed of ieee infocom, 2002. 61 