gener trade reduct mechan mira gonen electr engin dept. tel aviv univers ramat aviv 69978, israel gonenmir@post.tau.ac.il rica gonen∗ yahoo! research yahoo! sunnyval, ca 94089 gonenr@yahoo-inc.com elan pavlov media lab mit cambridg ma, 02149 elan@mit.edu abstract when design a mechan there ar sever desir properti to maintain such as incent compat (ic), individu ration (ir), and budget balanc (bb). it is well known [15] that it is imposs for a mechan to maxim social welfar whilst also be ir, ic, and bb. there have been sever attempt to circumv [15] by  trade welfar for bb, e.g., in domain such as doubl-side auction[13], distribut market[3] and suppli chain  problem[2, 4]. in thi paper we provid a procedur call a  gener trade reduct (gtr) for singl-valu player, which given an ir and ic mechan, output a mechan which is ir, ic and bb with a loss of welfar. we bound the welfar achiev by our procedur for a wide rang of  domain. in particular, our result improv on exist  solut for problem such as doubl side market with  homogen good, distribut market and sever kind of suppli chain. furthermor, our solut provid  budget balanc mechan for sever open problem such as combinatori doubl-side auction and distribut  market with strateg transport edg. categori and subject descriptor j.4 [social and behavior scienc]: econom; k.4.4 [electron commerc]: payment scheme gener term algorithm, design, econom, theori 1. introduct when design a mechan there ar sever kei  properti that ar desir to maintain. some of the more import on ar individu ration (ir) - to make it worthwhil for all player to particip, incent  compat (ic) - to give incent to player to report their true valu to the mechan and budget balanc (bb) - not to run the mechan on a loss. in mani of the mechan the goal function that a mechan design attempt to maxim is the social welfar1 - the total benefit to societi. howev, it is well known from [15] that ani mechan that maxim social welfar while maintain individu  ration and incent compat run a deficit perforc, i.e., is not budget balanc. of cours, for mani applic of practic import we lack the will and the capabl to allow the mechan to run a deficit and henc on must balanc the payment made by the mechan. to maintain the bb properti in an ir and ic mechan it is necessari to compromis on the optim of the social welfar. 1.1 relat work and specif solut there have been sever attempt to design budget  balanc mechan for particular domain2 . for instanc, for doubl-side auction where both the buyer and seller ar strateg and the good ar homogen [13] (or when the good ar heterogen [5]). [13] develop a  mechan that given valuat of buyer and seller produc an alloc (which ar the trade player) and a match between buyer and seller such that the mechan is ir, ic, and bb while retain most of the social welfar. in the distribut market problem (and close relat problem) good ar transport between geograph locat while incur some constant cost for transport. [16, 9, 3] present mechan that approxim the social welfar while achiev an ir, ic and bb mechan. for suppli chain problem [2, 4] bound the loss of social welfar that is necessari to inflict on the mechan in order to achiev the desir combin of ir, ic, and bb. despit the work discuss abov, the question of how to design a gener mechan that achiev ir, ic, and bb independ of the problem domain remain open.  furthermor, there ar sever domain where the question of how to design an ir, ic and bb mechan which  approx1 social welfar is also refer to as effici in the  econom literatur. 2 a brief remind of all of the problem us in thi paper can be found in appendix b 20 imat the social welfar remain an open problem. for exampl, in the import domain of combinatori  doublesid auction there is no known result that bound the loss of social welfar need to achiev budget balanc. anoth interest exampl is the open question left by [3]:how can on bound the loss in social welfar that is need to achiev budget balanc in an ir and ic distribut market where the transport edg ar strateg. natur an answer to the bb distribut market with strateg edg ha vast practic implic, for exampl to transport  network. 1.2 our contribut in thi paper we unifi all the problem discuss abov (both the solv as well as the open on) into on solut concept procedur. the solut procedur call the  gener trade reduct (gtr). gtr accept an ir and ic mechan for singl-valu player and output an ir, ic and bb mechan. the output mechan mai suffer some welfar loss as a tradeoff of achiev bb. there ar problem instanc in which no welfar loss is necessari but by [15] there ar problem instanc in which there is welfar loss. nevertheless for a wide class of problem we ar abl to bound the loss in welfar. a particularli interest case is on in which the input mechan is an effici alloc. in addit to unifi mani of the bb problem under a singl solut concept, the gtr procedur improv on exist result and solv sever open problem in the  literatur. the exist solut our gtr procedur improv ar homogen doubl-side auction, distribut market [3], and suppli chain [2, 4]. for the homogen  doublesid auction the gtr solut procedur improv on the well known solut [13] by allow for some case of no trade reduct at all. for the distribut market [3] and the suppli chain [2, 4] the gtr solut procedur improv on the welfar loss" bound, i.e., allow on to achiev an ir, ic and bb mechan with smaller loss on the social welfar. recent we also learn that the gtr procedur allow on to turn the model newli present [6] into a bb mechan. the open problem that ar answer by gtr ar distribut market with strateg transport edg and bound path, combinatori doubl-side  auction with bound size of the trade group i.e., a buyer and it bundl good" seller, combinatori doubl-side  auction with bound number of possibl trade group. in addit to the main contribut describ abov, thi paper also defin an import classif of problem  domain. we defin class base domain and procur class base domain. the abov definit build on the  differ competit power of player in a mechan call intern and extern competit. most of the studi  problem domain ar of the more restrict procur class domain and we believ that the more gener set will inspir more research. 2. preliminari 2.1 the model in thi paper we design a method which given ani ir and ic mechan output a mechan that maintain the ic and ir properti while achiev bb. for some class of mechan we bound the competit approxim of welfar. in our model there ar n player divid into set of trade. the set of trade ar call procur set and ar defin (follow [2]) as follow: definit 2.1. a procur set s is the smallest set of player that is requir for trade to occur. for exampl, in a doubl-side auction, a procur set is a pair consist of a buyer and a seller. in a  combinatori doubl-side auction a procur set can consist of a buyer and sever seller. we mark the set of all  procur set as s and assum that ani alloc is a disjoint union of procur set. each player i, 1 ≤ i ≤ n, assign a real valu vi(s) to each possibl procur set s ∈ s. name, vi(s) is the valuat of player i on procur set s. we assum that for each player i vi(s) is i"s privat valu and that i is a singl valu player, mean that if vi(sj) > 0 then for everi other sk, k = j, either vi(sk) = vi(sj) or vi(sk) = 0. for the eas of notat we will mark by vi the valu of player i for ani procur set s such that vi(s) > 0. the set vi ⊆ r is the set of all possibl valuat vi. the set of all possibl valuat of all the player is denot by v = v1 × ... × vn. let v−i = (v1, ..., vi−1, vi+1, ..., vn) be the vector of valuat of all the player besid player i, and let v−i be the set of all possibl vector v−i. we denot by w(s) the valu of a procur set s ∈ s such that w(s) = i∈s vi(s) + f(s), where f is some function that assign a constant to procur set. for exampl, f can be a (non-strateg) transport cost in a distribut market problem. let the size of a procur set s be denot as |s|. it is assum that ani alloc is a disjoint union of procur set and therefor on can sai that an  alloc partit the player into two set; a set of player that trade and a set of player that do not trade. the paper denot by o the set of possibl partit of an alloc a into procur set. the valu w(a) of an alloc a is the sum of the valu of it most effici  partit to procur set, that is w(a) = max∈o s∈s w(s). thi mean that w(a) = i∈a vi +max∈o s∈s f(s). in the case where f is ident zero, then w(a) = i∈a vi. an optim partit s∗ (a) is a partit that maxim the abov sum for an alloc a. let the valu of a be w(s∗ (a)) (note that the valu can depend on f). we sai that the alloc a is effici if there is no other alloc with a higher valu. the effici of the alloc ˆa is w ( ˆa) w (a) , where a is a maxim valu alloc. we assum w.l.o.g. that there ar no two alloc with the same valu3 . a mechan m defin an alloc and payment rule, m = (r, p). a payment rule p decid i"s payment pi where p is a function p : v → rn . we work with mechan 3 ti can be broken us the ident of the player. 21 in which player ar requir to report their valu. an exampl of such a mechan is the vcg mechan [17, 8, 10]. the report valu bi ∈ vi of player i is call a bid and might be differ from hi privat valu vi. let b ∈ v be the bid of all player. an alloc rule r decid the alloc accord to the report valu b ∈ v . we make the standard assumpt that player have quasi-linear util so that when player i trade and pai pi then hi util is ui(vi, b−i) = vi − pi, ui : v ⇒ r. we also assum that player ar ration util maxim. mechan m is budget balanc (bb) if i∈n pi ≥ 0 for ani bid b ∈ v . m is incent-compat (ic) in  domin strategi if for ani player i, valu vi and ani b−i ∈ v−i, ui(vi, b−i) ≥ ui(b) mean that for ani player i, bid vi maxim i"s util over all possibl bid of the other  player. m is (ex-post) individu ration (ir) if for ani player i valu vi, and ani b−i ∈ v−i ui(vi, b−i) ≥ 0  mean that for all possibl bid of the other player, player"s i util is non-neg. note that sinc our mechan ar normal ir, if a player doe not trade then the player pai 0 and ha util 0. our algorithm present in the next section emploi a commonli us payment scheme, the critic valu payment scheme. definit 2.2. critic valu payment scheme: a  mechan us a critic valu payment scheme if given an  alloc it charg player the minimum valu thei need to report to the mechan in order to remain alloc. we denot by ci the critic valu price comput for player i. 2.2 competit and domain in thi paper we present two gener trade reduct algorithm. the two algorithm ar such that given an ir and ic mechan m that solv a problem in some  domain (differ domain ar formal defin below), turn m into ir, ic and bb mechan. the algorithm present find procur set and remov them in iter until the right condit ar fulfil and the mechan m is turn into a bb on. the right condit that need to be met ar condit of competit among the player in the given problem. the follow definit lead us to the competit condit we ar look for. definit 2.3. for ani player i ∈ n, we sai that the set ri ⊆ n \ {i} is a replac set of i, if for ani  procur set s ∈ s such that i ∈ s and ri∩s = ∅, s\{i}∪ri ∈ s. for exampl, in a (homogen) doubl-side auction (see problem b.1) the replac set for ani buyer is simpli ani other buyer. in an auction for transport slot (see problem b.7), the replac set of an edg is a path  between the endpoint of the edg. note that a set can replac a singl player. furthermor, thi relationship is transit but not necessarili symmetr. if i is a replac set for j, it is not necessarili true that j is a replac set for i. definit 2.4. for ani alloc a, procur set s ⊆ a, and ani i ∈ s we sai ri(a, s) is an intern  competit for i with respect to a and s, if ri(a, s) ⊆ n \ a is a replac set for i s.t. t = s \ {i} ∪ ri(a, s) ∈ s and w(t) ≥ 0. definit 2.5. for ani alloc a and procur set s ⊆ a and ani i ∈ s we sai that ei(a, s) is an extern competit for i with respect to a and s, if ei(a, s) ⊆ n \ a is a set s.t., t = {i} ∪ ei(a, s) ∈ s and w(t) ≥ 0. we will assum, without loss of gener, that there ar no ti between the valu of ani alloc, and in  particular there ar no ti between valu of procur set. in case of ti, these can be broken by us the ident of the player4 . so for ani alloc a, procur set s and player i with extern competit ei(a, s), there exist exactli on set repres the maxim valu extern competit. definit 2.6. a set x ⊂ n is close under  replac if ∀i ∈ x then ri ⊂ x the follow defin the requir competit need to maintain ic, ir and bb. the set x5 denot thi  competit and is close under replac. in the remaind of the paper we will assum that all of our set which defin competit in a mechan ar close under replac. definit 2.7. let x ⊂ n be a set that is close under replac, we sai that the mechan is an x-extern mechan, if 1. each player i ∈ x ha an extern competit. 2. each player i /∈ x ha an intern competit. 3. for all player i1, . . . , it ∈ s \ x there exist ri1 (a, s), . . . , rit (a, s) such that for everi iz = iq, riz (a, s) ∩ riq (a, s) = ∅ 4. for everi procur set s ∈ s it hold that s∩x = ∅ for gener domain the choic of x can be crucial. in fact even for the same domain the welfar (and revenu) can vari wide depend on how x is defin. in appendix c we give an exampl where two possibl choic of x yield greatli differ result. although we show that x should be chosen as small as possibl we do not give ani  character of the optim of x and thi is an import open problem. our two gener trade reduct algorithm will  ensur that for ani alloc we have the desir type of competit. so given a mechan m that is ic and ir with alloc a, the goal of the algorithm is to turn m into an x-extern mechan. the two gener trade reduct algorithm util a divid function d which  divid alloc a into disjoint procur set. the  algorithm order the procur set defin by d in order of increas valu. for ani procur set there is a  desir type of competit that depend onli on the player who compos the procur set. the gener trade reduct algorithm go over the procur set in order (from the smallest to the largest) and remov ani  procur set that doe not have the desir competit when the set is reach. the reduct of procur set will also be refer to as a trade reduct. formal, 4 the detail of how to break ti in alloc ar standard and ar omit. 5 we present some tradeoff between the differ possibl set in appendix c. 22 definit 2.8. d is a divid function if for ani  alloc a and the player" valu vector v, d divid the  alloc into disjoint procur set s1, . . . , sk s.t. ∪sj = a and for ani player i with valu vi if i ∈ sj1 and t ∈ sj2 s.t. j1 ≥ j2 then for ani valu vi > vi of player i and divis by d into s1, . . . , sk such that i ∈ sj1 and t ∈ sj2 then j1 > j2. the two gener trade reduct algorithm present accept problem in differ domain. the formal domain definit follow: definit 2.9. a domain is a class domain if for all i ∈ n and all replac set of i, ri, |ri| = 1 and for all i, j, i = j if j = ri then i = rj. intuit, thi mean that replac set ar of size 1 and the replac relationship is symmetr. we defin the class of a player i as the set of the player"s replac set and denot the class of player i by [i]. it is import to note that sinc replac set ar transit relat and sinc class domain also impos symmetr  relat on the replac set, the class of a player i, [i] is actual an equival class for i. definit 2.10. a domain is a procur-class  domain if the domain is a class-base domain and if for ani player i such that there exist two procur set s1, s2 (not necessarili trade simultan in ani alloc) such that i ∈ s1 and i ∈ s2 then there exist a biject f : s1 → s2 such that for ani j ∈ s1, f(j) is a replac set for j in s2. exampl 2.1. a (homogen) doubl-side auction (see problem b.1) is a procur-class base domain. for the (homogen) doubl-side auction each procur set consist of a buyer and a seller. the doubl side combinatori auction consist of a  singl multi-mind buyer and multipl seller of heterogen good (see problem b.9), is a class base domain (as we have a singl buyer) but not a procur-class base domain. in thi case, the buyer is a class and each set of seller of the same good is a class. howev, for a buyer there is no biject between the differ the procur set of the bundl of good the buyer is interest in. the spatial-distribut market with strateg edg (see problem b.6) is not a class-base domain (and therefor not a procur-class domain). for exampl, even for a fix buyer and a fix seller there ar two differ procur set consist of differ path between the buyer and  seller. the next section present two algorithm gtr-1 and  gtr2. gtr-1 accept problem in procur-class base  domain, it properti ar prove with a gener divid  function d. the gtr-2 algorithm accept problem in ani  domain. we prove the gtr-2"s properti with specif  divid function d0. the function will be defin in section 4. sinc the divid function can have a larg practic impact on welfar (and revenu) the gener of gtr − 1 (albeit in special domain) can be an import practic consider. 3. procur-class base domain thi section focus on the problem that ar  procurementclass base domain. for thi domain, we present an  algorithm call gtr-1, which given a mechan that is ir and ic output a mechan with reduc welfar which is ir, ic and budget balanc. although procur class domain appear to be a  rel restrict model, in fact mani domain studi in the literatur ar procur class domain. exampl 3.1. the follow domain ar procur class domain: • doubl-side auction with homogen good  [13](problem b.1). in thi domain there ar two class. the class of buyer and the class of seller. each  procur set consist of a singl buyer and a singl seller. sinc everi pair of (buyer, seller) is a valid  procur set (albeit possibl with neg valu) thi is a procur class domain. in thi domain the constant assign to the procur set is f = 0. • spatial distribut market with non strateg edg [3, 9](problem b.3). like the doubl-side auction with homogen good, their ar two class in the  domain. class of buyer and class of seller with  procur set consist of singl buyer and singl seller. the seller and buyer ar node in a graph and the function f is the distanc of two node (length of the edg) which repres transport cost. these cost  differ between differ (buyer, seller) pair. • suppli chain [2, 4] (problem b.5). the assumpt of uniqu manufactori by [2, 4] can best be understood as turn gener suppli chain (which need not be a procur class domain) into a procur class domain. • singl mind combinatori auction [11] (problem b.8). in thi context each seller sell a singl good and each buyer want a set of good. the class ar the set of seller sell the same good as well as the buyer who desir the same bundl. a procur set consist of a singl buyer as well as a set of seller who can satisfi that buyer. a definit of the mechan follow: definit 3.1. the gtr-1 algorithm - given a  mechan m, a set x ⊂ n which is close under replac, a divid function d, and alloc a, gtr-1 oper as follow: 1. us the divid function d to divid a into  procur set s1, . . . , sk ∈ s. 2. order the procur set by increas valu. 3. for each sj, start from the lowest valu procur set: if for everi i ∈ sj ∩ x there is extern competit and everi i ∈ sj \ x there is intern competit then 23 keep sj. otherwis reduc the trade sj (i.e., remov everi i ∈ sj from the alloc).6 4. all trade player ar charg the critic valu for trade. all non trade player ar charg noth. remark 3.1. the special case where x = n ha receiv attent under differ guis in variou special case, such as ([13, 3, 4]). 3.1 the gtr-1 produc an x-extern mechan that is ir, ic and bb in thi subsect we prove that the gtr-1 algorithm produc an x-extern mechan that is ir, ic and bb. to prove gtr-1"s properti we make us of theorem 3.1 which is a well known result (e.g., [14, 11]). theorem 3.1 character necessari and suffici condit for a  mechan for singl valu player to be ir and ic: definit 3.2. an alloc rule r is bid monoton if for ani player i, ani bid of the other player b−i ∈ v−i, and ani two possibl bid of i, ˆbi > bi, if i trade under the alloc rule r when report bi, then i also trade when report ˆbi. intuit, a bid monoton alloc rule ensur that no trade player can becom a non-trade player by  improv hi bid. theorem 3.1. an ir mechan m with alloc rule r is ic if and onli if r is bid monoton and each trade player i pai hi critic valu ci (pi = ci). so for normal ir7 and ic mechan, the alloc rule which is bid monoton uniqu defin the critic  valu for all the player and thu the payment. observ 3.1. let m1 and m2 be two ir and ic mechan with the same alloc rule. then m1 and m2 must have the same payment rule. in the follow we prove that the x-extern gtr-1  algorithm produc a ir, ic and bb mechan, but first a subsidiari lemma is shown. lemma 3.1. for procur class domain if there  exist a procur set sj s.t. i ∈ sj and i ha extern competit than all t = i t ∈ sj, t ha intern competit. proof. thi follow from the definit of procur class domain. suppos that i ha extern competit, then there exist a set of player ei(a, s) such that {i} ∪ ei(a, s) ∈ s. let us denot by sj = {i} ∪ ei(a, s). sinc the domain is a procur-class domain there exist a  biject function f between sj and sj. f defin the requir intern competit. we start by prove ir and ic: 6 although the definit of an x-extern mechan  requir that x intersect everi procur set, thi is not strictli necessari. it is possibl to defin an x that doe not intersect everi possibl procur set. in thi case, ani procur set s ∈ s s.t. s ∩ x = ∅ will be reduc. 7 note that thi is not true for mechan which ar not normal e.g., [7, 12] lemma 3.2. for ani x, the x-extern mechan with a critic valu price scheme produc by the gtr-1  algorithm is an ir and ic mechan. proof. by the definit of a critic valu price scheme 2.2 and the gtr-1 algorithm 3.1 it follow that for everi trade player i, vi ≥ 0. by the gtr-1 algorithm 3.1  nontrad player i have a payment of zero. thu for everi player i, valu vi, and ani b−i ∈ v−i ui(vi, b−i) ≥ 0,  mean the produc x-extern mechan is ir. as the x-extern gtr-1 algorithm is ir and appli the critic valu payment scheme accord to theorem 3.1, in order to show that the produc x-extern mechan with the critic valu payment scheme is ic, it remain to show that the produc mechan"s alloc rule is bid monoton. sinc gtr-1 order the procur set accord to  increas valu, if player i increas hi bid from bi to bi > bi then for ani divis function d of procur set, the procur set s contain i alwai appear later with the bid bi than with the bid bi. so the likelihood of  competit can onli increas if i appear in later procur set. thi follow as gtr-1 can reduc more of the lower valu procur set which will result in more non-trade player. therefor if s ha the requir competit and is not reduc with bi then it will have the requir competit with bi and will not be reduc. final we prove bb: lemma 3.3. for ani x, the x-extern mechan with critic valu price scheme produc by the gtr-1  algorithm is a bb mechan. proof. in order to show that the produc mechan is bb we show that each procur set that is not reduc ha a posit budget (i.e., the sum of payment is posit). let s ∈ s be a procur set that is not reduc. let i ∈ s ∩ x then accord to the definit of x-extern definit 2.7 and the gtr-1 algorithm 3.1 i ha an extern competit. assum w.l.o.g.8 that i is the onli player with extern competit in s and all other player j = i, j ∈ s have intern competit. let a be the alloc after the procur set  reduct by the gtr-1 algorithm. accord to the definit of extern competit 2.5, there exist a set ei(a, s) ⊂ n \a such that i ∪ ei(a, s) ∈ s and w(i ∪ ei(a, s)) ≥ 0. sinc w(i∪ei(a, s)) = vi +w(ei(a, s)) then vi ≥ −w(ei(a, s)). by the critic valu price scheme definit 2.2 it mean that if player i bid ani less than −w(ei(a, s)) he will not have extern competit and therefor will be remov from trade. thu i pai no less than min −w(ei(a, s)). sinc all other player j ∈ s have intern competit their critic price can not be less than their maxim valu  intern competitor (set) i.e., max w(rj(a, s)). if ani player j ∈ s bid less then it maxim intern competitor (set) then he will not be in s but hi maxim intern competitor (set) will. as a possibl ei(a, s) is ∪j∈srj(a, s) on can bound the maxim valu of i"s extern competit w(ei(a, s)) by the sum of the maxim valu of the rest of the player in s 8 sinc the domain is a procur class domain we can us lemma 3.1 24 intern competit i.e., j∈s max w(rj(a, s)). therefor min −w(ei(a, s)) = −( j∈s max w(rj(a, s))). as the f function is defin to be a posit constant we get that w(s) = min −w(ei(a, s))+( j∈s max w(rj(a, s)))+f(s) ≥ 0 and thu s is at least budget balanc. as each  procur set that is not reduc is at least budget balanc, it follow that the produc x-extern mechan is bb. the abov two lemma yield the follow theorem: theorem 3.2. for procur class domain for ani x, the x-extern mechan with critic valu price scheme produc by the gtr-1 algorithm is an ir, ic and bb mechan. remark 3.2. the proof of the theorem yield bound on the payment ani player ha to make to the mechan. 4. non procur-class base domain the main reason that gtr-1 work for the  procurementclass domain is that each player"s possibl of be  reduc is monoton. by the definit of a divid function if a player i ∈ sj increas hi valu, i can onli appear in later procur set sj and henc ha a higher chanc of have the desir competit. therefor, the chanc of i lack the requisit  competit is decreas. sinc the domain is a procur class domain, all other player t = i,t ∈ sj ar also more like to have competit sinc member of their class continu to appear befor i and henc the likelihood that i will be reduc is decreas. sinc by theorem 3.1 a necessari and suffici condit for the mechan to be ic is  monoton. gtr-1 is ic for procur-class domain. howev, for domain that ar not procur class  domain thi doe not suffic even if the domain is a class base domain. although, all member of sj continu to have the requir competit it is possibl that there ar member of sj who do not have analogu in sj who do not have  competit. henc i might be reduc after increas hi valu which by lemma 3.1 mean the mechan is not ic. we therefor defin a differ algorithm for non  procur class domain. our modifi algorithm requir a special divid  function in order to maintain the ic properti. although our restrict to thi special divid function appear  stringent, the divid function we us is a gener of the wai that procur set ar chosen in procur-class base domain e.g., [13, 16, 9, 3, 2, 4]. for eas of present in thi section we assum that f = 0. the divid function for gener domain is defin by look at all possibl divid function. for each  divid function di and each set of bid, the gtr-1 algorithm yield a welfar that is a function of the bid and the  divid function9 . we denot by d0 the divid function that divid the player into set s.t. the welfar that gtr-1 find is maxim10 . 9 note that for ani particular di thi might not be ic as gtr-1 is ic onli for procur class domain and not for gener domain 10 in appendix a we show how to calcul d0 in  polynoform, let d be the set of all divid function d. denot the welfar achiev by the mechan produc by  gtr1 when us divid function d and a set of bid ¯b by gtr1(d,¯b). denot by d0(¯b) = argmaxd∈d(gtr1(d,¯b)). for eas of present we denot d0(¯b) by d0 when the depend on b is clear from the context. remark 4.1. d0 is an element of the set of divid  function, and therefor is a divid function. the second gener trade reduct algorithm gtr-2 follow. definit 4.1. the gtr-2 algorithm - given  mechan m, alloc a, and a set x ⊂ n close under  replac, gtr-2 oper as follow: 1. calcul the divid function d0 as defin abov. 2. us the divid function d0 to divid a into  procur set s1, . . . , sk ∈ s. 3. for each sj, start from the lowest valu  procur set, do the follow: if for i ∈ sj ∩ x there is an extern competit and there is at most on i ∈ sj that doe not have an  intern competit then keep sj. otherwis, reduc the trade sj. 4. all trade player ar charg the critic valu for trade. all non trade player ar charg zero. 11 we will prove that the mechan produc by gtr-2 maintain the desir properti of ir, ic, and bb. the  follow lemma show that the gtr-2 produc mechan is ir, and ic. lemma 4.1. for ani x, the x-extern mechan with critic valu price scheme produc by the gtr-2  algorithm is an ir and ic mechan. proof. by theorem 3.1 it suffic to prove that the  produc mechan by the gtr-2 algorithm is bid monoton for everi player i. suppos that i wa not reduc when  bid bi we need to prove that i will not be reduc when  bid bi > bi. denot by d1 = d0(b) the divid function us by gtr-2 when i report bi and the rest of the  player report b−i. denot by d1 = d0(bi, b−i) the divid function us by gtr-2 when i report bi and the rest of the player report b−i. denot by ¯d1(b) a maxim  divid function that result in gtr-1 reduc i when  report bi. assum to the contrari that gtr-2 reduc i from the trade when i report bi then gtr1(d1, (bi, b−i)) = gtr1( ¯d1, b). sinc d1 ∈ d it follow that gtr1(d1, b) > gtr1( ¯d1, b) and therefor gtr1(d1, b) > gtr1(d1, (bi, b−i)). howev accord to the definit d1 ∈ d, gtr-2 should not have reduc i mial time for procur-class domain. calcul d0 in polynomi time for gener domain is an import open problem. 11 in the full version gtr-2 is extend such that it suffic that there exist some time in which the third step hold. that extens is omit from current version due to lack of space. 25 with the divid function d1 and gain a greater welfar than gtr1(d1, b). thu a contradict aris and and gtr-2 doe not reduc i from the trade when i report bi > bi. lemma 4.2. for ani x, the x-extern mechan with critic valu price scheme produc by the gtr-2  algorithm is a bb mechan. proof. thi proof is similar to the proof of lemma 3.3. combin the two lemma abov we get: theorem 4.1. for ani x close under replac, the x-extern mechan with critic valu price scheme produc by the gtr-2 algorithm is an ir, ic and bb  mechan. appendix a show how to calcul d0 for procur class domain in polynomi time, it is not gener known how to easili calcul d0. creat a gener method for calcul the need divid function in polynomi time remain as an open question. 4.1 bound the welfar for  procurementclass base domain and other gener domain case thi section show that in addit to produc a  mechan with the desir properti, gtr-2 also produc a mechan that maintain high welfar. sinc the gtr-2 algorithm find a budget balanc mechan in arbitrari domain we ar unabl to bound the welfar for gener case. howev we can bound the welfar for  procurementclass base domain and a wide varieti of case in gener domain which includ mani case previous studi. definit 4.2. denot freqk([i], sj) to indic that a class [i] appear in a procur set sj, k time and there ar k member of [i] in sj. definit 4.3. denot by freqk([i], s) the maxim k s.t. there ar k member of [i] in sj. i.e., freqk([i], s) = maxsj ∈s freqk([i], sj). let the set of equival class in procur class base domain mechan be ec and |ec| be the number of those equival class. us the definit of class appear frequenc we can bound the welfar achiev by the gtr-2 produc  mechan for procur class domain12 : lemma 4.3. for procur class domain with f = 0, the number of procur set that ar reduc by gtr-213 is at most |ec| time the maxim frequenc of each class. formal, the maxim number of procur set that is reduc is o( [i]∈ec freqk([i], s)) proof. let d be an arbitrari divid function. we note that by definit ani procur set sj will not be reduc if everi i ∈ sj ha both intern competit and extern competit. 12 the welfar achiev by gtr-1 can also be bound for the case present in thi section. howev, we focu on gtr-2 as it alwai achiev better welfar. 13 or gtr-1 everi procur set s that is reduc ha at least on player i who ha no competit. onc s is reduc all player of [i] have intern competit. so by reduc the number of equival class |ec| procur set we cover all the remain player with intern competit. if the maxim frequenc of everi equival class wa on then each remain player t in procur set sk also have extern competit as all the intern competitor of player ¯t = t, ¯t ∈ sk ar an extern competit for t. if we have freqk([t], s) player from class [t] who were reduc then there is suffici extern competit for all player in sk. therefor it suffic to reduc o( [i]∈ec freqk([i], s))  procur set in order to ensur that both the requisit  intern and extern competit exist. the next theorem follow as an immedi corollari for lemma 4.3: theorem 4.2. given procur-class base domain  mechan with h procur set, the effici is at least a 1 − o( o( [i]∈ec freqk([i],s)) h ) fraction of the optim welfar. the follow corollari ar direct result of theorem 4.2. all of these corollari either improv prior result or achiev the same welfar as prior result. corollari 4.1. us gtr-2 for homogen  doublesid auction (problem b.1) at most14 on procur set must be reduc. similarli, for spatial distribut market without  strateg edg (problem b.3) us gtr-2 improv the result of [3] where a minimum cycl includ a buyer and seller is reduc. corollari 4.2. us gtr-2 for spatial distribut market without strateg edg at most on cycl per  connect compon15 will be reduc. for suppli chain (problem b.5) us gtr-2 improv the result of [2, 4] similar to corollari 4.2. corollari 4.3. us gtr-2 for suppli chain at most on cycl per connect compon16 will be reduc. the follow corollari solv the open problem at [3]. corollari 4.4. for distribut market on n node with strateg agent and path of bound length k (problem b.6) it suffic to remov at most k ∗ n procur set. proof. sketch: these will creat at least k span tree, henc we can disjointli cover everi remain  procur set. thi improv the naiv algorithm of reduc n2 procur set. we provid result for two special case of doubl side ca with singl valu player (problem b.8). 14 it is possibl that no reduct will be made, for instanc when there is a non-trade player who is the requisit  extern competit. 15 similar to the doubl-side auction, sometim there will be enough competit without a reduct. 16 similar to doubl-side auction, sometim there will be enough competit without a reduct. 26 corollari 4.5. if there ar at most m differ kind of procur set it suffic to remov m procur set. corollari 4.6. if there ar k type of good and each procur set consist of at most on of each type it  suffic to remov at most k procur set. 5. conclus and futur work in thi paper we present a gener solut procedur call the gener trade reduct (gtr). gtr  accept an ir and ic mechan as an input and output mechan that ar ir, ic and bb. the output  mechan achiev welfar that is close to optim for a wide rang of domain. the gtr procedur improv on exist result such as homogen doubl-side auction, distribut market, and suppli chain, and solv sever open problem such as distribut market with strateg transport edg and bound path, combinatori doubl-side auction with bound size procur set, and combinatori  doublesid auction with a bound number of procur set. the question of the qualiti of welfar approxim both in gener and in class domain that ar not procur class domain is an import and interest open  question. we also leav open the question of upper bound for the qualiti of approxim of welfar. although we know that it is imposs to have ir, ic and bb in an effici mechan it would be interest to have an upper bound on the approxim to welfar achiev in an ir, ic and bb mechan. the gtr procedur output a mechan which depend on a set x ⊂ n. anoth interest question is what the qualiti of approxim is when x is chosen randomli from n befor valuat ar declar. acknowledg the author wish to thank eva tardo et al for share their result with us. the author also wish to express their  gratitud to the help comment of the anonym review. 6. refer [1] a. archer and e. tardo. frugal path mechan. symposium on discret algorithm, proceed of the thirteenth annual acm-siam symposium on discret algorithm,2002. [2] m. babaioff and n. nisan. concurr auction across the suppli chain. journal of artifici intellig research,2004. [3] babaioff m., nisan n. and pavlov e. mechan for a spatial distribut market. in proceed of the 5th acm confer on electron commerc,2004. [4] m. babaioff and w. e. walsh. incent-compat, budget-balanc, yet highli effici auction for suppli chain format. in proceed of fourth acm confer on electron commerc,2003. [5] y. bartal, r. gonen and p. la mura. negoti-rang mechan: explor the limit of truth effici market. ec "04: proceed of the 5th acm confer on electron commerc, 2004. [6] blume l, easlei d., kleinberg j. and tardo e. trade network with price-set agent. in proceed of the 8th acm confer on electron commerc,2007. [7] cavallo r. optim decis-make with minim wast: strategyproof redistribut of vcg payment. in proc. 5th int. conf. on auton. agent and multi-agent system (aama06). [8] e. h. clark multipart price of public good. in journal public choic 1971, vol. 2, pp. 17-33. [9] chu l. y. and shen zuo-jun m. agent competit doubl auction mechan. manag scienc,vol 52(8),2006. [10] t. grove incent in team. in journal econometrica 1973, vol. 41, pp. 617-631. [11] d. lehmann, l. i. o"callaghan, and y. shoham. truth revel in approxim effici combinatori auction. in journal of acm 2002, vol. 49(5), pp. 577-602. [12] leonard h. elicit of honest prefer for the assign of individu to posit. journal of polit econ,1983. [13] mcafe r. p. a domin strategi doubl auction. journal of econom theori,vol 56, 434-450, 1992. [14] a. mu"alem, and n. nisan. truth approxim mechan for restrict combinatori auction. proceed of aaai 2002. [15] myerson r. b. and satterthwait m. a. effici mechan for bilater trade. journal of econom theori,vol 29, 265-281, 1983. [16] roundi r., chen r., janakriraman g. and zhang r. q. effici auction mechan for suppli chain procur. school of oper research and industri engin, cornel univers,2001. [17] w. vickrei counterspecul, auction and competit seal tender. in journal of financ 1961, vol. 16, pp. 8-37. appendix a. calcul the optim divid function in procur class domain in polynomi time in thi section we show how to calcul the optim  divid function for procur class domain in polynomi time. we first defin a special divid function d0 which is easi to calcul: we defin the divid function d0 recurs as follow: at stage j, d0 divid the trade player into two set aj and aj s.t. • aj is a procur set • aj can be divid into a disjoint union of procur set. • aj ha minim valu from all possibl such partit. defin sj = aj and recurs invok d0 and aj until aj = ∅. we now prove that d0 is the requir divid function. lemma a.1. for procur class domain d0 = d0. proof. sinc the domain is a procur class domain, for everi reduc procur set the set of player which achiev competit (either intern or extern) is fix. 27 therefor, the number of procur set which ar  reduc is independ of the divid function d. sinc the goal is to optim welfar by reduc procur set with the least valu we can optim welfar. thi is achiev by d0. b. problem and exampl for complet we present in thi section the formal  definit of the problem that we us to illustr our  mechan. the first problem that we defin is the doubl-side  auction with homogen good. problem b.1. doubl-side auction with  homogen good: there ar m seller each of which have a singl good (all good ar ident) and n buyer each of which ar interest in receiv a good. we denot the set of seller by s and the set of buyer by b. everi player i ∈ s ∪ b (both buyer and seller) ha a valu vi for the good. in thi model a procur set consist of a singl buyer and a singl seller, i.e., |s| = 2. the valu of a  procur set is w(s) = vj − vi where j ∈ b and i ∈ s, i.e., the gain from trade. if procur set ar creat by match the highest valu buyer to the lowest valu seller then [13]"s  determinist trade reduct mechan17 reduc the lowest valu procur set. a relat model is the pair relat cost [9] model. problem b.2. the pair relat cost: a doubl-side auction b.1 in which everi pair of player i ∈ s and j ∈ b ha a relat cost f(i, j) ≥ 0 in order to trade. f(i, j) is a friction cost which should be minim in order to maxim welfar. [9] defin two budget-balanc mechan for thi case. on of [9]"s mechan ha the set of buyer b as the x set for the x-extern mechan and the other ha the set of seller s as the x set for the x-extern mechan. a similar model is the spatial distribut market (sdm) model [3] in which there is a graph impos relationship on the cost. problem b.3. spatial distribut market: there is a graph g = (v, e) such that each v ∈ v ha a set of seller sv and a set of buyer bv . each edg e ∈ e ha an associ cost which is the cost to transport a singl unit of good along the edg. the edg ar non strateg but all player ar strateg. [3] defin a budget balanc mechan for thi case. our paper improv on [3] result. anoth graph model is the model defin in [6]. problem b.4. trade network: given a graph and buyer and seller who ar situat on node of the graph. all trade must pass through a trader. in thi case  procur set ar of the form (buyer, seller, trader) where the possibl set of thi form ar defin by a graph. the suppli chain model [2, 4] can be seen as a  gener of [6] in which procur set consist of the form (produc, consum, trader1, . . . , traderk). 17 it is also possibl to random the reduct of  procur set so as to achiev an expect budget of zero similar to [13], detail ar obviou and omit. problem b.5. suppli chain: there is a set d of agent and a set g of good and a graph g = (v, e) which defin possibl trade relationship. agent can requir an input of multipl quantiti of good in order to output a singl good. the produc type of player can produc good out of  noth, the consum ha a valuat and an entir chain of interim trader is necessari to creat a viabl procur set. [2, 4] consid uniqu manufactur technolog in which the graph defin possibl relationship is a tree. all of the abov problem ar procur-class domain. we also consid sever problem which ar not  procur class domain and gener the question of budget balanc have been left as open problem. an open problem rais in [3] is the sdm model in which edg ar strateg. problem b.6. spatial distribut market with strateg edg: there is a graph g = (v, e) such that each v ∈ v ha a set of seller sv and a set of buyer bv . each edg e ∈ e ha an associ cost which is the cost to transport a singl unit of good along the edg. each buyer,seller and edg ha a valu for the trade, i.e., all  entiti ar strateg. [2, 4] left open the question of budget balanc  mechan for suppli chain where there is no uniqu  manufactur technolog. it is easi to see that thi problem is not a procur class domain. anoth interest problem is transport network. problem b.7. transport network: a graph g = (v, e) where the edg ar strateg player with cost and the goal is to find a minimum cost transport rout between a pair of privileg node sourc, target ∈ v . it wa shown in [1] that the effici alloc can have a budget deficit that is linear in the number of player. clearli, thi problem is not a procur class domain and [1] left the question of a budget balanc mechan open. anoth non procur-class base domain mechan is the doubl-side combinatori auction (ca) with  singlevalu player. problem b.8. doubl-side combinatori auction (ca) with singl valu player: there exist a set s of seller each sell a singl good. there also exist a set b of buyer each interest in bundl of 2s18 . there ar two variant of thi problem. in the singl mind case each buyer ha a posit valu for onli a  singl subset wherea in the multi mind case each buyer can have multipl bundl with posit valuat but all of the valu ar the same. in both case we assum free dispos so that all bundl contain the desir bundl have the same valu for the buyer. we also consid problem that ar non class domain. problem b.9. doubl-side combinatori auction (ca) with gener multi-mind player: same as b.8 but each buyer can have multipl bundl with posit  valuat which ar not necessarili the same. 18 we abus notat and identifi the seller with the good. 28 c. compar differ choic of x the choic of x can have a larg impact on the welfar (and revenu) of the reduc mechan and therefor the question aris of how on should choos the set x. as the x-extern mechan is requir to maintain ic clearli the choic of x can not depend on the valu of the player as otherwis the reduc mechan will not be truth. in thi section we motiv the choic of small x set for procur class domain and give intuit that it mai also be the case for some other domain. we start by illustr the effect of the set x over the welfar and revenu in the doubl-side auction with  homogen good problem b.1. similar exampl can be construct for the other problem defin is b. the follow exampl show an effect on the welfar. exampl c.1. there ar two buyer and two seller and two non intersect (incompar) set x = {buyer} and y = {seller}. if the valu of the buyer ar 101, 100 and the seller ar 150, 1 then the x-extern mechan will yield a gain from trade of 0 and the y -extern mechan will yield a gain from trade of 100. convers, if the buyer valu ar 100, 1 and the seller ar 2, 3 the x-extern mechan will yield a gain from trade of 98 and and the y -extern mechan will yield a gain from trade of zero. the exampl clearli show that the differ between the x-extern and the y -extern mechan is unbound although as shown abov the fraction each of them reduc can be bound and therefor the multipl ratio between them can be bound (as a function of the number of trade). on the revenu side we can not even bound the ratio as seen from the follow exampl: exampl c.2. consid k buyer with valu 100 and k+ 1 seller with valu 1. if x = {buyer} then there is no need to reduc ani trade and all of the buyer receiv the good and pai 1. k + 1 of the seller sell and each of them receiv 1. thi yield a net revenu of zero. if y = {seller} then on must reduc a trade! thi mean that all of the buyer pai 100 while all of the  seller still receiv 1. the revenu is then 99k. similarli, an exampl can be construct that yield much higher revenu for the x-extern mechan as compar to the y -extern mechan. the abov exampl refer to set x and y which do not intersect and ar incompar. the follow theorem  compar the x-extern and y -extern mechan for  procur class domain where x is a subset of y . theorem c.1. for procur class domain, if x ⊂ y and for ani s ∈ s, s ∩ x ∩ y = ∅ then: 1. the effici of the x extern mechan in gtr-1 (and henc gtr-2) is at least that of the y -extern mechan. 2. ani win player that win in both the x-extern and y -extern mechan pai no less in the y -extern than in the x-extern and therefor the ratio of  budget to welfar is no wors in the y extern then the x-extern. proof. 1. for ani divid function d if there is a procur set sj that is reduc in the x-extern mechan there ar two possibl reason: (a) sj lack extern competit in the x-extern  mechan. in thi case sj lack extern competit in the intern mechan. (b) sj ha all requir extern competit in x-extern. in thi case sj ha all requir intern  competit in y -extern by lemma 3.1 but might lack some extern competit for sj ∪ {y \ x} and be reduc, 2. thi follow from the fact that for ani order d ani procur set s that is reduc in the x-extern mechan is also reduc in the y -extern  mechan. therefor, the critic valu is no less in the  yextern mechan than the x-extern mechan. remark c.1. for ani two set x, y it is easi to build an exampl in which the x-extern and y -extern  mechan reduc the same procur set so the inequ is weak. theorem c.1 show an inequ in welfar as well as for payment but it is easi to construct an exampl in which the revenu can increas for x as compar to y as well as the opposit. thi suggest that in gener we want x to be as small as possibl although in some domain it is not possibl to compar differ x"s. 29 