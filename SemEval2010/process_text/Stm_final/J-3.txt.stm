budget optim in search-base advertis auction jon feldman googl, inc. new york, ny jonfeld@googl.com s. muthukrishnan googl, inc. new york, ny muthu@googl.com martin p´al googl, inc. new york, ny mpal@googl.com cliff stein ∗ depart of ieor columbia univers cliff@ieor.columbia.edu abstract internet search compani sell advertis slot base on user" search queri via an auction. while there ha been previou work on the auction process and it game-theoret aspect, most of it focus on the internet compani. in thi work, we focu on the advertis, who must solv a complex optim problem to decid how to place bid on  keyword to maxim their return (the number of user click on their ad) for a given budget. we model the entir process and studi thi budget optim problem. while most variant ar np-hard, we show, perhap surprisingli, that simpli random between two uniform strategi that bid equal on all the keyword work well. more precis, thi strategi get at least a 1 − 1/e fraction of the maximum click possibl. as our preliminari experi show, such uniform strategi ar like to be practic. we also present inapproxim result, and optim algorithm for  variant of the budget optim problem. categori and subject descriptor f.2 [theori of comput]: analysi of algorithm and problem complex; j.4 [comput applic]: social and behavior scienc -econom gener term algorithm, econom, theori. 1. introduct onlin search is now ubiquit and internet search  compani such as googl, yahoo! and msn let compani and individu advertis base on search queri pose by user. convent media outlet, such as tv station or  newspap, price their ad slot individu, and the advertis bui the on thei can afford. in contrast, internet search compani find it difficult to set a price explicitli for the advertis thei place in respons to user queri. thi difficulti aris becaus suppli (and demand) vari wide and unpredict across the user queri, and thei must price slot for billion of such queri in real time. thu, thei reli on the market to determin suitabl price by  us auction amongst the advertis. it is a challeng problem to set up the auction in order to effect a stabl market in which all the parti (the advertis, user as well as the internet search compani) ar adequ  satisfi. recent there ha been systemat studi of the issu involv in the game theori of the auction [5, 1, 2], revenu maxim [10], etc. the perspect in thi paper is not of the internet search compani that displai the advertis, but rather of the advertis. the challeng from an advertis"s point of view is to understand and interact with the auction mechan. the advertis determin a set of keyword of their interest and then must creat ad, set the bid for each keyword, and provid a total (often daili) budget. when a user pose a search queri, the internet search compani determin the advertis whose keyword match the queri and who still have budget left over, run an auction amongst them, and present the set of ad correspond to the advertis who win the auction. the advertis whose ad appear pai the internet search compani if the user click on the ad. the focu in thi paper is on how the advertis bid. for the particular choic of keyword of their interest1 , an advertis want to optim the overal effect of the  advertis campaign. while the effect of an ad campaign in ani medium is a complic phenomenon to quantifi, on commonli accept (and easili quantifi) notion in  searchbas advertis on the internet is to maxim the number of click. the internet search compani ar support  to1 the choic of keyword is relat to the domain-knowledg of the advertis, user behavior and strateg consider. internet search compani provid the advertis with  summari of the queri traffic which is us for them to  optim their keyword choic interact. we do not directli address the choic of keyword in thi paper, which is  address elsewher [13]. 40 ward advertis and provid statist about the histori of click volum and predict about the futur perform of variou keyword. still, thi is a complex problem for the follow reason (among other): • individu keyword have significantli differ  characterist from each other; e.g., while fish is a broad keyword that match mani user queri and ha mani compet advertis, human fish bait is a nich keyword that match onli a few queri, but might have less competit. • there ar complex interact between keyword  becaus a user queri mai match two or more keyword, sinc the advertis is try to cover all the possibl keyword in some domain. in effect the advertis end up compet with herself. as a result, the advertis face a challeng optim problem. the focu of thi paper is to solv thi optim problem. 1.1 the budget optim problem we present a short discuss and formul of the  optim problem face by advertis; a more detail descript is in section 2. a given advertis see the state of the auction for  searchbas advertis as follow. there is a set k of keyword of interest; in practic, even small advertis typic have a larg set k. there is a set q of queri pose by the user. for each queri q ∈ q, there ar function give the clicksq(b) and costq(b) that result from bid a particular amount b in the auction for that queri, which we model more formal in the next section. there is a bipartit graph g on the two vertex set repres k and q. for ani queri q ∈ q, the neighbor of q in k ar the keyword that ar said to match the queri q.2 the budget optim problem is as follow. given graph g togeth with the function clicksq(·) and costq(·) on the queri, as well as a budget u, determin the bid bk for each keyword k ∈ k such that p q clicksq(bq) is  maxim subject to p q costq(bq) ≤ u, where the effect bid bq on a queri is some function of the keyword bid in the neighborhood of q. while we can cast thi problem as a tradit  optim problem, there ar differ challeng in practic  depend on the advertis"s access to the queri and graph inform, and inde the reliabl of thi inform (e.g., it could be base on unstabl histor data). thu it is import to find solut to thi problem that not onli get mani click, but ar also simpl, robust and less  reliant on the inform. in thi paper we defin the notion of a uniform strategi which is essenti a strategi that bid uniformli on all keyword. sinc thi type of strategi obviat the need to know anyth about the particular of the graph, and effect aggreg the click and cost function on the queri, it is quit robust, and thu  desir in practic. what is surpris is that uniform strategi actual perform well, which we will prove. 2 the particular of the match rule ar determin by the internet search compani; here we treat the function as arbitrari. 1.2 our main result and technic overview we present posit and neg result for the budget optim problem. in particular, we show: • nearli all formul of the problem ar np-hard. in case slightli more gener than the formul abov, where the click have weight, the problem is inapproxim  better than a factor of 1 − 1 e , unless p=np. • we give a (1−1/e)-approxim algorithm for the budget optim problem. the strategi found by the algorithm is a two-bid uniform strategi, which mean that it  random between bid some valu b1 on all keyword, and  bid some other valu b2 on all keyword until the budget is exhaust3 . we show that thi approxim ratio is tight for uniform strategi. we also give a (1/2)-approxim algorithm that offer a singl-bid uniform strategi, onli  us on valu b1. (thi is tight for singl-bid uniform  strategi.) these strategi can be comput in time nearli linear in |q| + |k|, the input size. uniform strategi mai appear to be naiv in first  consider becaus the keyword vari significantli in their click and cost function, and there mai be complex  interact between them when multipl keyword ar relev to a queri. after all, the optimum can configur arbitrari bid on each of the keyword. even for the simpl case when the graph is a match, the optim algorithm involv  place differ bid on differ keyword via a knapsack-like pack (section 2). so, it might be surpris that a simpl two-bid uniform strategi is 63% or more effect compar to the optimum. in fact, our proof is stronger, show that thi strategi is 63% effect against a strictli more  power adversari who can bid independ on the individu queri, i.e., not be constrain by the interact impos by the graph g. our proof of the 1 − 1/e approxim ratio reli on an adversari analysi. we defin a factor-reveal lp  (section 4) where primal solut correspond to possibl  instanc, and dual solut correspond to distribut over bid strategi. by deriv the optim solut to thi lp, we obtain both the proof of the approxim ratio, and a tight worst-case instanc. we have conduct simul us real auction data from googl. the result of these simul, which ar highlight at the end of section 4, suggest that uniform bid strategi could be us in practic. howev,  import question remain about (among other thing)  altern bid goal, on-line or stochast bid model [11], and game-theoret concern [3], which we briefli discuss in section 8. 2. model a keyword auction we describ an auction from an advertis"s point of view. an advertis bid on a keyword, which we can think of as a word or set of word. user of the search engin submit queri. if the queri match a keyword that ha been bid on by an advertis, then the advertis is enter into an auction for the avail ad slot on the result page. what constitut a match vari depend on the search engin. 3 thi type of strategi can also be interpret as bid on valu (on all keyword) for part of the dai, and a differ valu for the rest of the dai. 41 an advertis make a singl bid for a keyword that  remain in effect for a period of time, sai on dai. the  keyword could match mani differ user queri throughout the dai. each user queri might have a differ set of  advertis compet for click. the advertis could also bid differ amount on multipl keyword, each match a (possibl overlap) set of user queri. the ultim goal of an advertis is to maxim traffic to their websit, given a certain advertis budget. we now formal a model of keyword bid and defin an optim problem that captur thi goal. 2.1 landscap we begin by consid the case of a singl keyword that match a singl user queri. in thi section we defin the notion of a queri landscap that describ the relationship between the advertis"s bid and what will happen on thi queri as a result of thi bid[9]. thi definit will be central to the discuss as we continu to more gener case. 2.1.1 posit, bid and click-through rate the search result page for a queri contain p possibl posit in which our ad can appear. we denot the highest (most favor) posit by 1 and lowest by p. associ with each posit i is a valu α[i] that denot the click-through rate (ctr) of the ad in posit i. the ctr is a measur of how like it is that our ad will receiv a click if place in posit i. the ctr can be measur empir us past histori. we assum throughout thi work that that α[i] ≤ α[j] if j < i, that is, higher posit receiv at least as mani click as lower posit. in order to place an ad on thi page, we must enter the auction that is carri out among all advertis that have submit a bid on a keyword that match the user"s queri. we will refer to such an auction as a queri auction, to  emphas that there is an auction for each queri rather than for each keyword. we assum that the auction is a  gener second price (gsp) auction [5, 7]: the advertis ar rank in decreas order of bid, and each advertis is assign a price equal to the amount bid by the advertis below them in the rank.4 in sponsor search auction, thi advertis pai onli if the user actual click on the ad. let (b[1], . . . , b[p]) denot the bid of the top p advertis in thi queri auction. for notat conveni, we assum that b[0] = ∞ and b[p] = α[p] = 0. sinc the auction is a gener second price auction, higher bid win higher posit; i.e. b[i] ≥ b[i + 1]. suppos that we bid b on some keyword that match the user"s queri, then our posit is defin by the largest b[i] that is at most b, that is, po(b) = arg max i (b[i] : b[i] ≤ b). (1) sinc we onli pai if the user click (and that happen with probabl α[i]), our expect cost for win posit i 4 googl, yahoo! and msn all us some variant of the gsp auction. in the googl auction, the advertis" bid ar multipli by a qualiti score befor thei ar rank; our  result carri over to thi case as well, which we omit from thi paper for clariti. also, other auction besid gsp have been consid; e.g., the vickrei clark grove (vcg)  auction [14, 4, 7]. each auction mechan will result in a differ sort of optim problem. in the conclus we point out that for the vcg auction, the bid  optim problem becom quit easi. would be cost[i] = α[i] · b[i], where i = po(b). we us costq(b) and clicksq(b) to denot the expect cost and click that result from have a bid b that qualifi for a queri  auction q, and thu costq(b) = α[i] · b[i] where i = po(b), (2) clicksq(b) = α[i] where i = po(b). (3) the follow observ about cost and click follow  immedi from the definit and equat (1), (2) and (3). we us r+ to denot the nonneg real. observ 1. for b ∈ r+, 1. (costq(b), clicksq(b)) can onli take on on of a finit set of valu vq = {(cost[1], α[1]), . . . , (cost[p], α[p])}. 2. both costq(b) and clicksq(b) ar non-decreas  function of b. also, cost-per-click (cpc) costq(b)/clicksq(b) is non-decreas in b. 3. costq(b)/clicksq(b) ≤ b. for bid (b[1], . . . , b[p]) that correspond to the bid of other advertis, we have: costq(b[i])/clicksq(b[i]) = b[i], i ∈ [p]. when the context is clear, we drop the subscript q. 2.1.2 queri landscap we can summar the data contain in the function cost(b) and click(b) as a collect of point in a plot of cost vs. click, which we refer to as a landscap. for exampl, for a queri with four slot, a landscap might look like tabl 1. bid rang cost per click cost click [$2.60,∞) $2.60 $1.30 .5 [$2.00,$2.60) $2.00 $0.90 .45 [$1.60,$2.00) $1.60 $0.40 .25 [$0.50,$1.60) $0.50 $0.10 .2 [$0,$0.50) $0 $0 0 tabl 1: a landscap for a queri it is conveni to repres thi data graphic as in figur 1 (ignor the dash line for now). here we graph click as a function of cost. observ that in thi graph, the cpc (cost(b)/click(b)) of each point is the reciproc of the slope of the line from the origin to the point. sinc cost(b), click(b) and cost(b)/click(b) ar non-decreas, the slope of the line from the origin to success point on the plot decreas. thi condit is slightli weaker than concav. suppos we would like to solv the budget optim problem for a singl queri landscap.5 as we increas our bid from zero, our cost increas and our expect number of click increas, and so we simpli submit the highest bid such that we remain within our budget. on problem we see right awai is that sinc there ar onli a finit set of point in thi landscap, we mai not be abl to target arbitrari budget effici. suppos in the exampl from tabl 1 and figur 1 that we had a budget 5 of cours it is a bit unrealist to imagin that an advertis would have to worri about a budget if onli on user queri wa be consid; howev on could imagin multipl instanc of the same queri and the problem scale. 42 $0.50 $1.00 $1.50 .1 .2 .3 .4 .5 click cost figur 1: a bid landscap. of $1.00. bid between $2.00 and $2.60 us onli $0.90, and so we ar under-spend. bid more than $2.60 is not an option, sinc we would then incur a cost of $1.30 and overspend our budget. 2.1.3 random strategi to rectifi thi problem and better util our avail budget, we allow random bid strategi. let b be a distribut on bid b ∈ r+. now we defin cost(b) = eb∼b[cost(b)] and click(b) = eb∼b[click(b)]. graphic, the possibl valu of (cost(b), click(b)) lie in the convex hull of the landscap point. thi is repres in figur 1 by the dash line. to find a bid distribut b that maxim click subject to a budget, we simpli draw a vertic line on the plot where the cost is equal to the budget, and find the highest point on thi line in the convex hull. thi point will alwai be the convex combin of at most two origin landscap point which themselv lie on the convex hull. thu, given the point on the convex hull, it is easi to comput a distribut on two bid which led to thi point. summar, lemma 1. if an advertis is bid on on keyword, subject to a budget u, then the optim strategi is to pick a convex combin of (at most) two bid which ar at the endpoint of the line on the convex hull at the highest point for cost u. there is on subtleti in thi formul. given ani  bid strategi, random or otherwis, the result cost is itself a random variabl repres the expect cost. thu if our budget constraint is a hard budget, we have to deal with the difficulti that aris if our strategi would be over budget. therefor, we think of our budget constraint as soft, that is, we onli requir that our expect cost be less than the budget. in practic, the budget is often an averag daili budget, and thu we don"t worri if we exce it on dai, as long as we ar meet the budget in expect. further, either the advertis or the search engin (possibl both), monitor the cost incur over the dai; henc, the advertis"s bid can be chang to zero for part of the dai, so that the budget is not oversp.6 thu in the  remain6 see http://adword.googl.com/support/bin/answer. py?answer=22183, for exampl. der of thi paper, we will formul a budget constraint that onli need to be respect in expect. 2.1.4 multipl queri: a knapsack problem as a warm-up, we will consid next the case when we have a set of queri, each which it own landscap. we want to bid on each queri independ subject to our budget: the result optim problem is a small gener of the fraction knapsack problem, and wa solv in [9]. the first step of the algorithm is to take the convex hull of each landscap, as in figur 1, and remov ani  landscap point not on the convex hull. each piecewis linear section of the curv repres the increment number of click and cost incur by move on"s bid from on  particular valu to anoth. we regard these piec as item in an instanc of fraction knapsack with valu equal to the increment number of click and size equal to the  increment cost. more precis, for each piec connect two consecut bid b and b on the convex hull, we  creat a knapsack item with valu [click(b ) − click(b )] and size [cost(b ) − cost(b )]. we then emul the greedi  algorithm for knapsack, sort by valu/size (cost-per-click), and choos greedili until the budget is exhaust. in thi reduct to knapsack we have ignor the fact that some of the piec come from the same landscap and cannot be treat independ. howev, sinc each curv is concav, the piec that come from a particular queri curv ar in increas order of cost-per-click; thu from each landscap we have chosen for our knapsack a set of piec that form a prefix of the curv. 2.2 keyword interact in realiti, search advertis can bid on a larg set of  keyword, each of them qualifi for a differ (possibl  overlap) set of queri, but most search engin do not  allow an advertis to appear twice in the same search result page.7 thu, if an advertis ha a bid on two differ keyword that match the same queri, thi conflict must be resolv somehow. for exampl, if an advertis ha a bid out on the keyword shoe and high-heel, then if a user issu the queri high-heel shoe, it will match on two  differ keyword. the search engin specifi, in advanc, a rule for resolut base on the queri the keyword and the bid. a natur rule is to take the keyword with the highest bid, which we adopt here, but our result appli to other resolut rule. we model the keyword interact problem us an  undirect bipartit graph g = (k ∪ q, e) where k is a set of keyword and q is a set of queri. each q ∈ q ha an  associ landscap, as defin by costq(b) and clicksq(b). an edg (k, q) ∈ e mean that keyword k match queri q. the advertis can control their individu keyword bid vector a ∈ r |k| + specifi a bid ak for each keyword k ∈ k. (for now, we do not consid random bid, but we will introduc that shortli.) given a particular bid vector a on the keyword, we us the resolut rule of take the maximum to defin the effect bid on queri q as bq(a) = max k:(k,q)∈e ak. by submit a bid vector a, the advertis receiv some 7 see http://adword.googl.com/support/bin/answer. py?answer=14179, for exampl. 43 number of click and pai some cost on each keyword. we us the term spend to denot the total cost; similarli, we us the term traffic to denot the total number of click: spend(a)= x q∈q costq(bq(a)); traffic(a)= x q∈q clicksq(bq(a)) we also allow random strategi, where an advertis give a distribut a over bid vector a ∈ r |k| + . the  result spend and traffic ar given by spend(a)=ea∼a[spend(a)]; traffic(a)=ea∼a[traffic(a)] we can now state the problem in it full gener: budget optim input: a budget u, a keyword-queri graph g = (k ∪ q, e), and landscap (costq(·), clicksq(·)) for each q ∈ q. find: a distribut a over bid vector a ∈ r |k| + such that spend(a) ≤ u and traffic(a) is maxim. we conclud thi section with a small exampl to illustr some featur of the budget optim problem. suppos you have two keyword k = {u, v} and two queri q = {x, y} and edg e = {(u, x), (u, y), (v, y)}. suppos queri x ha on posit with ctr αx [1] = 1.0, and there is on bid bx 1 = $1. queri y ha two posit with ctr αy [1] = αy [2] = 1.0, and bid by 1 = $ and by 2 = $1 to get ani click from x, an advertis must bid at least $1 on u. howev, becaus of the structur of the graph, if the advertis set bu to $1, then hi effect bid is $1 on both x and y. thu he must trade-off between get the click from x and get the bargain of a click for $ that would be possibl otherwis. 3. uniform bid strategi as we will show in section 5, solv the budget  optim problem in it full gener is difficult. in  addit, it mai be difficult to reason about strategi that involv arbitrari distribut over arbitrari bid vector. advertis gener prefer strategi that ar easi to  understand, evalu and us within their larger goal. with thi motiv, we look at restrict class of strategi that we can easili comput, explain and analyz. we defin a uniform bid strategi to be a distribut a over bid vector a ∈ r |k| + where each bid vector in the distribut is of the form (b, b, . . . , b) for some real-valu bid b. in other word, each vector in the distribut bid the same valu on everi keyword. uniform strategi have sever advantag. first, thei do not depend on the edg of the interact graph, sinc all effect bid on queri ar the same. thu, thei ar effect in the face of limit or noisi inform about the keyword interact graph. second, uniform strategi ar also independ of the prioriti rule be us. third, ani algorithm that give an approxim guarante will then be valid for ani interact graph over those keyword and queri. we now show that we can comput the best uniform  strategi effici. suppos we have a set of queri q, where the landscap vq for each queri q is defin by the set of point vq = {(costq[1], αq[1]), . . . , (costq[p], αq[p])}. we defin the set of interest bid iq = {costq[1]/αq [1], . . . , costq[p]/αq [p]}, let i = ∪q∈qiq, and let n = |i|. we can index the point in i as b1, . . . , bn in increas order. the ith point in our aggreg landscap v is found by sum, over the queri, the cost and click associ with bid bi, that is, v = ∪n i=1( p q∈q costq(bi), p q∈q clicksq(bi)). for ani possibl bid b, if we us the aggreg landscap just as we would a regular landscap, we exactli repres the cost and click associ with make that bid  simultan on all queri associ with the aggreg  landscap. therefor, all the definit and result of section 2 about landscap can be extend to aggreg landscap, and we can appli lemma 1 to comput the best uniform strategi (us the convex hull of the point in thi  aggreg landscap). the run time is domin by the time to comput the convex hull, which is o(n log n)[12]. the result strategi is the convex combin of two point on the aggreg landscap. defin a two-bid strategi to be a uniform strategi which put non-zero weight on at most two bid vector. we have shown lemma 2. given an instanc of budget optim in which there ar a total of n point in all the landscap, we can find the best uniform strategi in o(n log n) time. furthermor, thi strategi will alwai be a two-bid strategi. put these idea togeth, we get an o(n log n)-time algorithm for budget optim, where n is the total number of landscap point (we later show that thi is a (1 − 1 e )-approxim algorithm): 1. aggreg all the point from the individu queri  landscap into a singl aggreg landscap. 2. find the convex hull of the point in the aggreg landscap. 3. comput the point on the convex hull for the given budget, which is the convex combin of two point α and β. 4. output the strategi which is the appropri convex combin of the uniform bid vector correspond to α and β. we will also consid a special case of two-bid strategi. a singl-bid strategi is a uniform strategi which put  nonzero weight on at most on non-zero vector, i.e. advertis random between bid a certain amount b∗ on all  keyword, and not bid at all. a singl-bid strategi is even easier to implement in practic than a two-bid strategi. for exampl, the search engin often allow advertis to set a maximum daili budget. in thi case, the advertis would simpli bid b∗ until her budget run out, and the ad serv system would remov her from all subsequ auction until the end of the dai. on could also us an ad schedul tool offer by some search compani8 to implement thi strategi. the best singl-bid strategi can also be comput easili from the aggreg landscap. the optim strategi for a budget u will either be the point x s.t. cost(x) is as larg as possibl without exceed u, or a convex  combin of zero and the point y, where cost(y) is as small as possibl while larger than u. 8 see http://adword.googl.com/support/bin/answer. py?answer=33227, for exampl. 44 b d a c click cost cpc a 2 $1 $0.50 b 5 $0.50 $0.10 c 3 $2 $0.67 d 4 $1 $0.25 cpc $0.67 $0.50 $0.25 $0.10 total click: 5 9 11 14 figur 2: four queri and their click-price curv. 4. approxim algorithm in the previou section we propos us uniform  strategi and gave an effici algorithm to comput the best such strategi. in section we prove that there is alwai a good uniform strategi: theorem 3. there alwai exist a uniform bid  strategi that is (1 − 1 e )-optim. furthermor, for ani > 0, there exist an instanc for which all uniform strategi ar at most (1 − 1 e + )-optim. we introduc the notion of a click-price curv, which is central to our analysi. thi definit make it simpl to show that there is alwai a singl-bid strategi that is a 1 2  approxim (and thi is tight); we then build on thi to prove theorem 3. 4.1 click-price curv consid a set of queri q, and for each queri q ∈ q, let (clicksq(·), costq(·)) be the correspond bid landscap. consid an adversari bidder Ω with the power to bid  independ on each queri. note that thi bidder is more power than an optim bidder, which ha to bid on the keyword. suppos thi strategi bid b∗ q for each queri q. thu, Ω achiev traffic cΩ = p i click(b∗ i ), and incur total spend uΩ = p i cost(b∗ i ). without loss of gener we can assum that Ω bid so that for each queri q, the cost per click is equal to b∗ q , i.e. costq(b∗ q )/clicksq(b∗ q ) = b∗ q . we mai assum thi becaus for some queri q, if costq(b∗ q)/clicksq(b∗ q) < b∗ q , we can alwai lower b∗ q and without chang the cost and click. to aid our discuss, we introduc the notion of a  clickpric curv (an exampl of which is shown in figur 2), which describ the cpc distribut obtain by Ω.  formal the curv is a non-decreas function h : [0, cΩ] → r+ defin as h(r) = min{c | p q:b∗ q ≤c clicksq(b∗ q ) ≥ r}.  anoth wai to construct thi curv is to sort the queri in increas order by b∗ q = costq(b∗ q)/clicksq(b∗ q), then make a step function where the qth step ha height b∗ q and width clicksq(b∗ q ) (see figur 2). note that the area of each step is costq(b∗ q ). the follow claim follow immedi: claim 1. uΩ = r cΩ 0 h(r)dr. suppos we want to bui some fraction r /cΩ of the traffic that Ω is get. the click-price curv sai that if we bid h(r ) on everi keyword (and therefor everi queri), we get at least r traffic, sinc thi bid would ensur that for all q such that b∗ q ≤ h(r ) we win as mani click as Ω. note that by bid h(r ) on everi keyword, we mai actual get even more than r traffic, sinc for queri q where b∗ q is much less than h(r ) we mai win more click than Ω. howev, all of these extra click still cost at most h(r ) per click. thu we see that for ani r ∈ [0, cΩ], if we bid h(r ) on everi keyword, we receiv at least r traffic at a total spend of at most h(r ) per click. note that by random between bid zero and bid h(r ), we can receiv exactli r traffic at a total spend of at most r · h(r ). we summar thi discuss in the follow lemma: lemma 4. for ani r ∈ [0, cΩ], there exist a singl-bid strategi that random between bid h(r) and bid zero, and thi strategi receiv exactli r traffic with total spend at most r · h(r). lemma 4 describ a landscap as a continu function. for our lower bound, we will need to show that given ani continu function, there exist a discret landscap that approxim it arbitrarili well. lemma 5. for ani c, u > 0 and non-decreas  function f : [0, c] → r+ such that r c 0 f(r)dr = u, and ani small > 0, there exist an instanc of budget  optim with budget u + , where the optim solut achiev c click at cost u + , and all uniform bid strategi ar convex combin of singl-bid strategi that achiev exactli r click at cost exactli rf(r) by bid f(r) on all keyword. proof. construct an instanc as follow. let > 0 be a small number that we will later defin in term of . defin r0 = 0, r1, r2, . . . , rm = c such that ri−1 < ri ≤ ri−1 + , f(ri−1) ≤ f(ri) ≤ f(ri−1)+ , and m ≤ (c +f(c))/ . (thi is possibl by choos ri"s space by min( , f(ri)−f(ri−1))) now make a queri qi for all i ∈ [m] with bidder bid h(ri), h(ri+1), . . . , h(rm), and ctr α[1] = α[2] = · · · = α[m− i+1] = ri −ri−1. the graph is a match with on keyword per queri, and so we can imagin the optim solut as bid on queri. the optim solut will alwai bid exactli h(ri) on queri qi, and if it did so on all queri, it would spend u := pm i=1(ri − ri−1)h(ri). defin small enough so that u = u + , which is alwai possibl sinc u ≤ z c 0 f(r)dr + mx i=1 (ri − ri−1)(h(ri) − h(ri−1)) ≤ u + 2 m ≤ u + (c + f(c)). note that the onli possibl bid (i.e., all other have the same result as on of these) ar f(r0), . . . , f(rm), and  bid uniformli with f(ri) result in pi j=1 ri − ri−1 = ri click at cost h(ri)ri. 4.2 a 1 2 -approxim algorithm us lemma 4 we can now show that there is a uniform singl-bid strategi that is 1 2 -optim. in addit to be an interest result in it own right, it also serv as a warm-up for our main result. theorem 6. there alwai exist a uniform singl-bid  strategi that is 1 2 -optim. furthermor, for ani > 0 there exist an instanc for which all singl-bid strategi ar at most (1 2 + )-optim. 45 proof. appli lemma 4 with r = cΩ/2, we see that there is a strategi that achiev traffic cΩ/2 with spend cΩ/2·h(cΩ/2). now, us the fact that h is a non-decreas function combin with claim 1, we have (cΩ/2)h(cΩ/2) ≤ z cΩ cΩ/2 h(r)dr ≤ z cΩ 0 h(r)dr = uΩ, (4) which show that we spend at most uΩ. we conclud that there is a 1 2 -optim singl-bid strategi random between bid cΩ/2 and zero. for the second part of the theorem, we construct a tight exampl us two queri q = {x, y}, two keyword k = {u, v}, and edg e = {(u, x), (v, y)}. fix some α where 0 < α ≤ 1, and fix some veri small > 0. queri x ha two posit, with bid of bx 1 = 1/α and bx 2 = , and with ident click-through rate αx [1] = αx [2] = α. queri y ha on posit, with a bid of by 1 = 1/α and a click-through rate of αy [1] = α. the budget is u = 1 + α. the optim solut is to bid on u (and therefor x) and bid 1/α on v (and therefor y), both with probabl 1. thi achiev a total of 2α click and spend the budget exactli. the onli us bid ar 0, and 1/α, sinc for both queri all other bid ar ident in term of cost and click to on of those three. ani singl-bid solut that us as it non-zero bid get at most α click. bid 1/α on both keyword result in 2α click and total cost 2. thu, sinc the budget is u = 1 + α < 2, a singl-bid solut us 1/α can put weight at most (1+ α)/2 on the 1/α bid. thi result in at most α(1 + α) click. thi can be made arbitrarili close to α by lower . 4.3 a (1 − 1 e )-approxim algorithm the kei to the proof of theorem 3 is to show that there is a distribut over singl-bid strategi from lemma 4 that obtain at least (1 − 1 e )cΩ click. in order to figur out the best distribut, we wrote a linear program that model the behavior of a player who is try to maxim click and an adversari who is try to creat an input that is hard for the player. then us linear program dualiti, we were abl to deriv both an optim strategi and a tight instanc. after solv the lp numer, we were also abl to see that there is a uniform strategi for the player that alwai obtain (1 − 1 e )cΩ click; and then from the solut were easili abl to guess the optim distribut. thi methodolog is similar to that us in work on factor-reveal lp [8, 10]. 4.3.1 an lp for the worst-case click-price curv. consid the adversari"s problem of find a click-price curv for which no uniform bid strategi can achiev αcΩ click. recal that by lemma 1 we can assum that a uniform strategi random between two bid u and v. we also assum that the uniform strategi us a convex  combin of strategi from lemma 4, which we can assum by lemma 5. thu, to achiev αcΩ click, a uniform strategi must random between bid h(u) and h(v) where u ≤ αcΩ and v ≥ αcΩ. call the set of such strategi s. given a (u, v) ∈ s, the necessari probabl in order to achiev αcΩ click ar easili determin, and we denot them by p1(u, v) and p2(u, v) respect. note further that the  advertis is try to figur out which of these strategi to us, and ultim want to comput a distribut over uniform strategi. in the lp, she is actual go to  comput a distribut over pair of strategi in s, which we will then interpret as a distribut over strategi. us thi set of uniform strategi as constraint, we can character a set of worst-case click-price curv by the  constraint z cΩ 0 h(r)dr ≤ u ∀(u, v) ∈ s p1(u, v)uh(u) + p2(u, v)vh(v) ≥ u a curv h that satisfi these constraint ha the properti that all uniform strategi that obtain αcΩ click spend more than u. discret thi set of inequ, and  push the first constraint into the object function, we get the follow lp over variabl hr repres the curv: min x r∈{0, ,2 ,...,cΩ} · hr s.t. ∀(u, v) ∈ s, p1(u, v)uhu + p2(u, v)vhv ≥ u in thi lp, s is defin in the discret domain as s = {(u, v) ∈ {0, , 2 , . . . , cΩ}2 : 0 ≤ u ≤ αcΩ ≤ v ≤ cΩ}. solv thi lp for a particular α, if we get an object less than u, we know (up to some discret) that an instanc of budget optim exist that cannot be approxim better than α. (the instanc is construct as in the proof of lemma 5.) a binari search yield the smallest such α where the object is exactli u. to obtain a strategi for the advertis, we look at the dual, constrain the object to be equal to u in order to get the polytop of optimum solut: x (u,v)∈s wu,v = 1 ∀(u, v) ∈ s, x v :(u,v )∈s p1(u, v ) · u · wu,v ≤ and x u :(u ,v)∈s p2(u , v) · v · wu ,v ≤ . it is straightforward to show that the second set of  constraint is equival to the follow: ∀h ∈ rcΩ/ : x r hr = u, x (u,v)∈s wu,v(p1(u, v) · u · hu + p2(u, v) · v · hv) ≤ u. here the variabl can be interpret as weight on strategi in s. a point in thi polytop repres a convex  combin over strategi in s, with the properti that for ani click-price curv h, the cost of the mix strategi is at most u. sinc all strategi in s get at least αcΩ click, we have a strategi that achiev an α-approxim.  interestingli, the equival between thi polytop and the lp dual abov show that there is a mixtur over valu r ∈ [0, c] that achiev an α-approxim for ani curv h. after a search for the appropri α (which turn out to be 1 − 1 e ), we solv these two lp and came up with the plot in figur 3, which reveal not onli the right  approxim ratio, but also a pictur of the worst-case distribut and the approxim-achiev strategi.9 from the  pic9 the paramet u and cΩ can be set arbitrarili us  scale argument. 46 0 0 c/e c 0 0 c/e c figur 3: the worst-case click-price curv and (1 − 1/e)-approxim uniform bid strategi, as found by linear program. ture, we were abl to quickli guess the optim strategi and worst case exampl. 4.3.2 proof of theorem 3 by lemma 4, we know that for each r ≤ uΩ, there is a strategi that can obtain traffic r at cost r · h(r). by mix strategi for multipl valu of r, we construct a uniform strategi that is guarante to achiev at least 1−e−1 = 0.63 fraction of Ω"s traffic and remain within budget. note that the final result bid distribut will have some weight on the zero bid, sinc the singl-bid strategi from lemma 4 put some weight on bid zero. consid the follow probabl densiti function over such strategi (also depict in figur 3): g(r) = j 0 for r < cΩ/e, 1/r for r ≥ cΩ/e. note that r cΩ 0 g(r)dr = r cΩ cΩ/e 1 r dr = 1, i.e. g is a  probabl densiti function. the traffic achiev by our strategi is equal to traffic = z cΩ 0 g(r)·r dr = z cΩ cΩ/e 1 r ·r dr = „ 1 − 1 e « cΩ. the expect total spend of thi strategi is at most spend = z cΩ 0 g(r) · rh(r) dr = z cΩ cΩ/e h(r) dr ≤ z cΩ 0 h(r) dr = uΩ. thu we have shown that there exist a uniform bid strategi that is (1 − 1 e )-optim. we now show that no uniform strategi can do better. we will prove that for all > 0 there exist an instanc for which all uniform strategi ar at most (1 − 1 e + )-optim. first we defin the follow click-price curv over the domain [0, 1]: h(r) = 8 < : 0 for r < e−1 1 e − 2 „ e − 1 r « for r ≥ e−1 note that h is non-decreas and non-neg. sinc the curv is over the domain [0, 1] it correspond to an instanc where cΩ = 1. note also that r 1 0 h(r) dr = 1 e−2 r 1 1/e e − 1 r dr = 1. thu, thi curv correspond to an instanc where uΩ = 1. us lemma 5, we construct an actual instanc where the best uniform strategi ar convex combin of strategi that bid h(u) and achiev u click and u · h(u) cost. suppos for the sake of contradict that there exist a uniform bid strategi that achiev α > 1−e−1 traffic on thi instanc. by lemma 1 there is alwai a two-bid optim uniform bid strategi and so we mai assum that the strategi achiev α click random over two bid. to achiev α click, the two bid must be on valu h(u) and h(v) with probabl pu and pv such that pu + pv = 1, 0 ≤ u ≤ α ≤ v and puu + pvv = α. to calcul the spend of thi strategi consid two case: if u = 0 then we ar bid h(v) with probabl pv = α/v. the spend in thi case is: spend = pv · v · h(v) = αh(v) = αe − α/v e − 2 . us v ≥ α and then α > 1 − 1 e we get spend ≥ αe − 1 e − 2 > (1 − 1/e)e − 1 e − 2 = 1, contradict the assumpt. we turn to the case u > 0. here we have pu = v−α v−u and pv = α−u v−u . note that for r ∈ (0, 1] we have h(r) ≥ 1 e−2 (e − 1 r ). thu spend ≥ pu · uh(u) + pv · vh(v) = (v − α)(ue − 1) + (α − u)(ve − 1) (v − u)(e − 2) = αe − 1 e − 2 > 1. the final inequ follow from α > 1 − 1 e . thu in both case the spend of our strategi is over the budget of 1. 4.4 experiment result we ran simul us the data avail at googl which we briefli summar here. we took a larg  advertis campaign, and, us the set of keyword in the  campaign, comput three differ curv (see figur 4) for three differ bid strategi. the x-axi is the  budget (unit remov), and the y-axi is the number of click obtain (again without unit) by the optim bid(s) under each respect strategi. queri bid repres our (unachiev) upper bound Ω, bid on each queri  independ. the uniform bid curv repres the result of appli our algorithm: determinist us a singl bid level, while random us a distribut. for refer, we includ the lower bound of a (e − 1)/e fraction of the top curv. the data clearli demonstr that the best singl  uniform bid obtain almost all the possibl click in practic. of cours in a more realist environ without full  knowledg, it is not alwai possibl to find the best such bid, so further investig is requir to make thi approach  us. howev, just know that there is such a bid avail should make the on-line version of the problem simpler. 5. hard result by a reduct from vertex cover we can show the  follow (proof omit): theorem 7. budget optim is strongli np-hard. 47 queri bid uniform bid (random) uniform bid (determinist) lower bound 0 0 0.5 0.5 1 1 budget click figur 4: an exampl with real data. now suppos we introduc weight on the queri that indic the rel valu of a click from the variou search user. formal, we have weight wq for all q ∈ q and our goal is maxim the total weight traffic given a budget. call thi the weight keyword bid problem. with thi addit gener we can show hard of approxim via a simpl reduct from the maximum coverag problem, which is known to be (1−1/e)-hard [6] (proof omit). theorem 8. the weight keyword bid  problem is hard to approxim to within (1 − 1/e). 6. exact algorithm for laminar graph if a graph ha special structur, we can sometim solv the budget optim problem exactli. note that the knapsack algorithm in section 2 solv the problem for the case when the graph is a simpl match. here we  gener thi to the case when the graph ha a laminar structur, which will allow us to impos a (partial) order on the possibl bid valu, and therebi give a pseudopolynomi algorithm via dynam program. we first show that to solv the budget optim problem (for gener graph) optim in pseudopolynomi time, it suffic to provid an algorithm that solv the  determinist case. the proof (omit) us idea similar to observ 1 and lemma 1. lemma 9. let i be an input to the budget  optim problem and suppos that we find the optim  determinist solut for everi possibl budget u ≤ u. then we can find the optim solut in time o(u log u). a collect s of n set s1, . . . , s2 is laminar if, for ani two set si and sj, if si ∩ sj = ∅ then either si ⊆ sj or sj ⊆ si. given a keyword interact graph g, we associ a set of neighbor queri qk = {q : (k, q) ∈ e} with each  keyword k. if thi collect of set if laminar, we sai that the graph ha the laminar properti. note that a laminar  interact graph would natur fall out as a consequ of design a hierarch keyword set (e.g., shoe,  highheel shoe, athlet shoe). we call a solut determinist if it consist of on bid vector, rather than a gener distribut over bid vector. the follow lemma will be us for give a structur to the optim solut, and will allow dynam program. lemma 10. for keyword i, j ∈ k, if qi ⊆ qj then there exist an optim determinist solut to the budget  optim problem with ai ≥ aj. we can view the laminar order as a tree with keyword j as a parent of keyword i if qj is the minim set contain qi. in thi case we sai that j is a child of i. given a keyword j with c children i1, . . . , ic, we now need to enumer over all wai to alloc the budget among the children and also over all possibl minimum bid for the children. a complic is that a node mai have mani children and thu a term of uc would not even be pseudopolynomi. we can solv thi problem by show that given ani laminar order, there is an equival on in which each keyword ha at most 2 children. lemma 11. let g be a graph with the laminar properti. there exist anoth graph g with the same optim solut to the budget optim problem, where each node ha at most two children in the laminar order. furthermor, g ha at most twice as mani node as g. given a graph with at most two children per node, we  defin f[i, b, u] to be the maximum number of click achiev by bid at least b on each of keyword j s.t. qj ⊆ qi (and exactli b on keyword i) while spend at most u. for thi definit, we us z(b, u) to denot set of allow bid and budget over children: z(b, u) = {b, b , u , u : b ≥ b, u ≤ u, b ≥ b, u ≤ u, u + u ≤ u} given a keyword i and a bid ai, comput an increment spend and traffic associ with bid ai on keyword i, that is ˆt(i, ai) = x q∈qi\qi−1 clicksq(ai), and ˆs(i, ai) = x q∈qi\qi−1 costq(ai). now we defin f[i, b, u] as max b, b ,u ,u ∈z(b,u) j f[j , b , u ] + f[j , b , u ] + ˆt(i, b) ff (5) if (ˆs(i, b) ≤ u − u − u and i > 0), and f[i, b, u] = 0 otherwis. lemma 12. if the graph g ha the laminar properti, then, after appli lemma 11, the dynam program  recurr in (5) find an optim determinist solut to the budget optim problem exactli in o(b3 u3 n) time. in addit, we can appli lemma 9 to comput the  optim (random) solut. observ that in the dynam program, we have alreadi solv the instanc for everi  budget u ≤ u, so we can find the random solut with no addit asymptot overhead. 48 lemma 13. if the graph g ha the laminar properti, then, by appli lemma 11, the dynam program recurr in (5), and lemma 9, we can find an optim solut to the budget optim problem in o(b3 u3 n) time. the bound in thi section make pessimist assumpt about have to try everi budget and everi level. for mani problem, you onli need to choos from a discret set of bid level (e.g., multipl of on cent). do so yield the obviou improv in the bound. 7. bid optim under vcg the gsp auction is not the onli possibl auction on could us for sponsor search. inde the vcg auction and variant [14, 4, 7, 1] offer altern with compel game-theoret properti. in thi section we argu that the budget optim problem is easi under the vcg auction. for a full definit of vcg and it applic to  sponsor search we refer the reader to [1, 2, 5]. for the sake of the budget optim problem we can defin vcg by just redefin costq(b) (replac equat (2)): costq(b) = p−1 x j=i (α[j] − α[j + 1]) · b[j] where i = po(b). observ 1 still hold, and we can construct a landscap as befor, where each landscap point correspond to a  particular bid b[i]. we claim that in the vcg auction, the landscap ar  convex. to see thi, consid two consecut posit i,i + 1. the slope of line segment between the point correspond to those two posit is cost(b[i]) − cost(b[i + 1]) click(b[i]) − click(b[i + 1]) = (α[i] − α[i + 1]) · b[i] α[i] − α[i + 1] = b[i]. sinc b[i] ≥ b[i + 1], the slope of the piec of the  landscap decreas, and we get that the curv is convex. now consid run the algorithm describ in  section 2.1.4 for find the optim bid for a set of queri. in thi algorithm we took all the piec from the landscap curv, sort them by increment cpc, then took a prefix of those piec, give us bid for each of the queri. but, the equat abov show that each piec ha it  increment cpc equal to the bid that achiev it; thu in the case of vcg the piec ar also sort by bid. henc we can obtain ani prefix of the piec via a uniform bid on all the  keyword. we conclud that the best uniform bid is an optim solut to the budget optim problem. 8. conclud remark our algorithm result present an intrigu heurist in practic: bid a singl valu b on all keyword; at the end of the dai, if the budget is under-spent, adjust b to be higher; if budget is oversp, adjust b to be lower; els, maintain b. if the scenario doe not chang from dai to dai, thi simpl strategi will have the same theoret properti as our on-bid strategi, and in practic, is like to be much better. of cours the scenario doe chang, howev, and so come up with a stochast bid strategi remain an import open direct, explor somewhat by [11, 13]. anoth interest gener is to consid weight on the click, which is a wai to model convers. (a  convers correspond to an action on the part of the user who click through to the advertis site; e.g., a sale or an  account sign-up.) final, we have look at thi system as a black box return click as a function of bid, wherea in realiti it is a complex repeat game involv multipl  advertis. in [3], it wa shown that when a set of advertis us a strategi similar to the on we suggest here, under a slightli modifi first-price auction, the price approach a well-understood market equilibrium. acknowledg we thank rohit rao, zoya svitkina and adam wildavski for help discuss. 9. refer [1] g. aggarw, a. goel and r. motwani. truth auction for price search keyword. acm confer on electron commerc, 1-7, 2006. [2] g. aggarw, j. feldman and s. muthukrishnan bid to the top: vcg and equilibria of posit-base auction proc. waoa, 2006. [3] c. borg, j. chay, o. etesami, n. immorlica, k. jain, and m. mahdian. dynam of bid optim in onlin advertis auction. proc. www 2007. [4] e. clark. multipart price of public good. public choic, 11(1):17-33, 1971. [5] b. edelman, m. ostrovski and m. schwarz. internet advertis and the gener second price auction: sell billion of dollar worth of keyword. second workshop on sponsor search auction, 2006. [6] u. feig. a threshold of ln n for approxim set cover. 28th acm symposium on theori of comput, 1996, pp. 314-318. [7] t. grove. incent in team. econometrica, 41(4): 617-631, 1973. [8] k. jain, m. mahdian, e. markaki, a. sabieri and v. vazirani. greedi facil locat algorithm analyz us dual fit with factor-reveal lp. j. acm, 50(6): 795-824, 2003. [9] w. labio, m. rose, s. ramaswami. intern document, googl, inc. mai, 2004. [10] a. mehta, a. saberi, u. vazirani, and v. vazirani, adword and gener onlin match. foc 2005. [11] s. muthukrishnan, m. p´al and z. svitkina. stochast model for budget optim in search-base advertis. to appear in 3rd workshop on sponsor search auction, www 2007. [12] f. preparata and m. shamo. comput geometri: an introduct. springer-verlag, new york, ny, 1985. [13] p. rusmevichientong and d. williamson. an adapt algorithm for select profit keyword for search-base advertis servic proc. 7th acm confer on electron commerc, 260 - 269, 2006. [14] w. vickrei. counterspecul, auction and competit-seal tender. journal of financ, 16(1):8-37, 1961. 49 