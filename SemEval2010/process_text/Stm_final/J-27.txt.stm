learn from reveal prefer [extend abstract] eyal beigman cm-em kellogg school of manag northwestern univers evanston il 60208 e-beigman@northwestern.edu rakesh vohra med kellogg school of manag northwestern univers evanston il 60208 r-vohra@northwestern.edu abstract a sequenc of price and demand ar rationaliz if there exist a concav, continu and monoton util function such that the demand ar the maxim of the util function over the budget set correspond to the price. afriat [1] present necessari and suffici condit for a finit sequenc to be rationaliz. varian [20] and later blundel et al. [3, 4] continu thi line of work studi nonparametr method to forecast demand. their result essenti character learnabl of degener class of demand function and therefor fall short of give a  gener degre of confid in the forecast. the present paper complement thi line of research by introduc a statist model and a measur of complex through which we ar abl to studi the learnabl of class of demand function and deriv a degre of confid in the forecast. our result show that the class of all demand function ha unbound complex and therefor is not learnabl, but that there exist interest and potenti us class that ar learnabl from finit sampl. we also present a learn algorithm that is an adapt of a new proof of afriat"s theorem due to teo and vohra [17]. categori and subject descriptor f.2 [theori of comput]: analysi of algorithm and problem complex; j.4 [comput applic]: social and behavior scienc-econom; i.2.6 [learn]: paramet learn gener term econom, algorithm, theori 1. introduct a market is an institut by which econom agent meet and make transact. classic econom theori explain the incent of the agent to engag in thi behavior through the agent" prefer over the set of avail bundl  indic that agent attempt to replac their current bundl with bundl that ar both more prefer and attain if such bundl exist. the prefer relat is therefor the kei factor in understand consum behavior. on of the common assumpt in thi theori is that the prefer relat is repres by a util function and that agent strive to maxim their util given a budget constraint. thi pattern of behavior is the essenc of suppli and demand, gener equilibria and other aspect of  consum theori. furthermor, as we elabor in section 2, basic observ on market demand behavior suggest that util function ar monoton and concav. thi bring us to the question, first rais by  samuelson [18], to what degre is thi theori refut? given  observ of price and demand, under what circumst can we conclud that the data is consist with the  behavior of a util maxim agent equip with a monoton concav util function and subject to a budget constraint? samuelson gave a necessari but insuffici condit on the underli prefer known as the weak axiom of reveal prefer. uzawa [16] and ma-colel [10, 11] introduc a notion of incom-lipschitz and show that demand  function with thi properti ar rationaliz. these properti do not requir ani parametr assumpt and ar  technic refut, but thei do assum knowledg of the entir demand function and reli heavili on the differenti  properti of demand function. henc, an infinit amount of inform is need to refut the theori. it is often the case that apart form the demand  observ there is addit inform on the system and it is sensibl to make parametr assumpt, name, to stipul some function form of util. consist with util maxim would then depend on fix the  paramet of the util function to be consist with the observ and with a set of equat call the  slutski equat. if such paramet exist, we conclud that the stipul util form is consist with the  observ. thi approach is us when there is reason to make these stipul, it give an explicit util function which can be us to make precis forecast on demand for  unob36 serv price. the downsid of thi approach is that real life data is often inconsist with conveni function form. moreov, if the observ ar inconsist it is unclear whether thi is a refut of the stipul function form or of util maxim. address these issu houthakk [7] note that an  observ can see onli finit quantiti of data. he ask when can it be determin that a finit set of observ is  consist with util maxim without make  parametr assumpt? he show that rationaliz of a finit set of observ is equival to the strong axiom of  reveal prefer. richter [15] show that strong axiom of reveal prefer is equival to rationaliz by a strictli concav monoton util function. afriat [1] give anoth set of rationaliz condit the observ must satisfi. varian [20] introduc the gener axiom of reveal prefer (garp), an equival form of afriat"s consist condit that is easier to verifi  computation. it is interest to note that these necessari and  suffici condit for rationaliz ar essenti version of the well known farka lemma [6] (see also [22]). afriat [1] prove hi theorem by an explicit construct of a util function wit consist. varian [20] took thi on step further progress from consist to  forecast. varian"s forecast algorithm basic rule out bundl that ar reveal inferior to observ bundl and find a bundl from the remain set that togeth with the observ is consist with garp. furthermor, he  introduc samuelson"s monei metric as a canon util function and give upper and lower envelop util function for the monei metric. knoblauch [9] show these envelop can be comput effici. varian [21] provid an up to date survei on thi line of research. a differ approach is present by blundel et al. [3, 4]. these paper introduc a model where an agent observ price and engel curv for these price. thi give an  improv on varian"s origin bound, though the basic idea is still to rule out demand that ar reveal inferior. thi model is in a sens a hybrid between ma-colel and afriat"s aproach. the former requir full inform for all price, the latter for a finit number of price. on the other hand the approach taken by blundel et al. requir full inform onli on a finit number of price  trajectori. the motiv for thi crossov is to util incom segment in the popul to restructur econometr inform. differ segment of the popul face the same price with differ budget, and as much as  aggreg data can testifi on individu prefer, show how demand vari with the budget. appli non parametr statist method, thei reconstruct a trajectori from the observ demand of differ segment and us it to obtain tighter bound. both these method would most like give a good forecast for a fix demand function after suffici mani  observ assum thei were spread out in a reason manner. howev, these method do not consid the complex of the demand function and do not us ani probabilist model of the observ. therefor, thei ar unabl to provid ani estim of the number of observ that would be suffici for a good forecast or the degre of confid in such a forecast. in thi paper we examin the feasibl of demand  forecast with a high degre of confid us afriat"s  condit. we formul the question in term of whether the class of demand function deriv from monoton concav util is effici pac-learnabl. our first result is  neg. we show, by comput the fat shatter dimens, that without ani prior assumpt, the set of all demand function induc by monoton concav util function is too rich to be effici pac-learnabl. howev, under some prior assumpt on the set of demand function we show that the fat shatter dimens is finit and therefor the correspond set ar pac-learnabl. in these case,  assum the probabl distribut by which the observ price-demand pair ar gener is fix, we ar in a  posit to offer a forecast and a probabilist estim on it accuraci. in section 2 we briefli discuss the basic assumpt of  demand theori and their implic. in section 3 we present a new proof to afriat"s theorem incorpor an algorithm for effici gener a forecast function due to teo and vohra [17]. we show that thi algorithm is  computation effici and can be us as a learn algorithm. in section 4 we give a brief introduct to pac learn includ sever modif to learn real vector  valu function. we introduc the notion of fat shatter dimens and us it to devis a lower bound on the  sampl complex. we also sketch result on upper bound. in section 5 we studi the learnabl of demand function and directli comput the fat shatter dimens of the class of all demand function and a class of incom-lipschitzian demand function with a bound global incom-lipschitz constant. 2. util and demand a util function u : rn + → r is a function relat  bundl of good to a cardin in a manner reflect the  prefer over the bundl. a ration agent with a budget that w.l.g equal 1 face a price vector p ∈ rn + will choos from her budget set b(p) = {x ∈ rn + : p · x ≤ 1} a bundl x ∈ rn + that maxim her privat util. the first assumpt we make is that the function is  monoton increas, name, if x ≥ y, in the sens that the inequ hold coordinatewis, then u(x) ≥ u(y). thi  reflect the assumpt that agent will alwai prefer more of ani on good. thi, of cours, doe not necessarili hold in practic, as in mani case excess suppli mai lead to  storag expens or other extern. howev, in such case the demand will be an interior point of the budget set and the less prefer bundl won"t be observ. the second assumpt we make on the util is that all the margin (partial deriv) ar monoton decreas. thi is the law of diminish margin util which assum that the larger the excess of on good over the other the less we valu each addit good of on kind over the other. these  assumpt impli that the util function is concav and monoton on the observ. the demand function of the agent is the correspond fu : rn + → rn + satisfi f(p) = argmax{u(x) : p · x ≤ i} in gener thi correspond is not necessarili singl  valu, but it is implicit in the proof of afriat"s theorem that ani set of observ can be ration by a demand function that is singl valu for unobserv price. 37 sinc larg quantiti of ani good ar like to creat  util decreas extern, we assum the price ar limit to a compact set. w.l.g. we assum u ha margin util zero outsid [0, 1]d . ani budget set that is not a subset of the support is maxim on ani point outsid the support and it is therefor difficult to forecast for these price. we ar thu interest in forecast for price below the simplex ∆d = conv{(0, . . . , 1, . . . , 0)}. for these price we take the metric dp (p, p ) = max{| 1 pi − 1 pi | : i = 1, . . . , d} for p, p ∈ ∆d. note that with thi metric ∆d is compact. a demand function is l-incom-lipschitz, for l ∈ r+, if ||f(p) − f(p )||∞ dp (p, p ) ≤ l for ani p, p ∈ ∆d. thi properti reflect an assumpt that prefer and demand have some sort of stabil. it rule out differ demand for the similar price. we mai therefor assum from here on that demand function ar singl valu. 3. reveal prefer a sequenc of price and demand (p1, x1), . . . , (pn, xn) is rationaliz if there exist a util function u such that xi = fu(pi) for i = 1, . . . , n. we begin with a trivial  observ, if pi · xj ≤ pi · xi and xi = f(pi) then xi is prefer over xj sinc the latter is in the budget set when the  former wa chosen. it is therefor reveal that u(xj) ≤ u(xi) impli pj · xj ≤ pj · xi. suppos there is a sequenc (pi1 , xi1 ), . . . , (pik , xik ) such that pij · (xij − xij+1 ) ≤ 0 for j = 1 . . . k − 1 and pik · (xik − xi1 ) ≤ 0. then the same reason show that u(xi1 ) = u(xi2 ) = . . . = u(xik ) impli pi1 · (xi1 − xi2 ) = pi2 · (xi2 − xi3 ) = . . . = pik−1 ·(xik−1 −xik ) = 0. we call the latter  condit the afriat condit (ac). thi argument show that ac is necessari for rationaliz; the surpris result in afriat"s theorem is that thi condit is also suffici. let a be an n × n matrix with entri aij = pi · (xj − xi) (aij and aji ar independ), aii = 0 and let d(a) be the weight digraph associ with a. the matrix satisfi ac if everi cycl with neg total weight includ at least on edg with posit weight. theorem 1. there exist y = (y1, . . . , yn) ∈ rn and s = (s1, . . . , sn) ∈ rn + satisfi the set of inequ l(a), yj ≤ yi + siaij i = j 1 ≤ i, j ≤ n iff d(a) satisfi ac. proof : if l(a) is feasibl then it is easi to see that u(x) = min i {yi + sipi(x − xi)} is a concav util function that is consist with the  observ, and from our previou remark it follow that d(a) satisfi ac. in the other direct it is shown by explicit  construct that afriat"s condit for d(a) impli l(a) is  feasibl. the construct provid a util function that is consist with the observ. teo and vohra [17] give a strongli polynomi time algorithm for thi construct which will be the heart of our learn algorithm. the construct is execut in two step. first, the  algorithm find s ∈ rn + such that the weight digraph d(a, s) defin by the matrix ˜aij = siaij ha no cycl with  neg total weight if d(a) satisfi ac and return a neg cycl otherwis. the dual of a shortest path problem is given by the  constraint: yj − yi ≤ siaij i = j it is a standard result (see [14] p 109) that the system is  feasibl iff d(a, s) ha no neg cycl. thu, in the second step, if d(a) satisfi ac, the algorithm call a  shortest path algorithm to find y ∈ rn satisfi the  constraint. now we describ how to choos the si"s. defin s = {(i, j) : aij < 0}, e = {(i, j) : aij = 0} and t = {(i, j) : aij > 0} and let g = ([n], s ∪ e) be a digraph with weight wij = −1 if (i, j) ∈ s and wij = 0 otherwis. d(a) ha no neg cycl, henc g is acycl and breadth first search can assign potenti φi such that φj ≤ φi + wij for (i, j) ∈ s ∪ e. we relabel the vertic so that φ1 ≥ φ2 ≥ . . . ≥ φn. let δi = (n − 1) max(i,j)∈s(−aij) min(i,j)∈t aij if φi < φi−1 and δi = 1 otherwis, and defin si = iy j=2 δj = δi · si−1 . we show that for thi choic of s, d(a, s) contain no neg weight cycl. suppos c = (i1, . . . , ik) is a cycl in d(a, s). if φ is constant on c then aij ij+1 = 0 for j = 1, . . . , k and we ar done. otherwis let iv ∈ c be the vertex with smallest potenti satisfi w.l.o.g. φ(iv) < φ(iv+1). for ani cycl c in the digraph d(a, s), let (v, u) be an edg in c such that (i) v ha the smallest potenti among all vertic in c, and (ii) φu > φv. such an edg exist, otherwis φi is ident for all vertic i in c. in thi case, all edg in c have non-neg edg weight in d(a, s). if (iv, iv+1) ∈ s ∪ e, then we have φ(iv+1) ≤ φ(iv) + wiv,iv+1 ≤ φ(iv) a contradict. henc (iv, iv+1) ∈ t. now, note that all vertic q in c with the same potenti as iv must be incid to an edg (q, t) in c such that φ(t) ≥ φ(q). henc the edg (q, t) must have non-neg weight. i.e., aq,t ≥ 0. let p denot a vertex in c with the second smallest potenti. now, c ha weight svavu+ x (k,l)∈c\(v,u) skak,l ≥ svav,u+sp(n−1) max (i,j)∈s {aij } ≥ 0, i.e., c ha non-neg weight ✷ algorithm 1 return in polynomi time a hypothesi that is a piecewis linear function and agre with the label of the observ name sampl error zero. to us thi function to forecast demand for unobserv price we need algorithm 2 which maxim the function on a given budget set. sinc u(x) = mini{yi + sipi(x − xi)} thi is a linear program and can be solv in time polynomi in d, n as well as the size of the largest number in the input. 38 algorithm 1 util algorithm input (x1, p1), . . . , (xn, pn) s ← {(i, j) : aij < 0} e ← {(i, j) : aij = 0} for all (i, j) ∈ s do wij ← −1 end for for all (i, j) ∈ e do wij ← 0 end for while there exist unvisit vertic do visit new vertex j assign potenti to φj end while reorder indic so φ1 ≤ φ2 . . . ≤ φn for all 1 ≤ i ≤ n do δi ← (n − 1) max(i,j)∈s (−aij ) min(i,j)∈t aij si ← qi j=2 δj end for shortest path(yj − yi ≤ siaij) return y1, . . . , yn ∈ rd and s1, . . . , sn ∈ r+ algorithm 2 evalu input y1, . . . , yn ∈ rd and s1, . . . , sn ∈ r+ max z z ≤ yi + sipi(x − xi) for i = 1, . . . , n px ≤ 1 return x for which z is maxim 4. supervis learn in a supervis learn problem, a learn algorithm is given a finit sampl of label observ as input and is requir to return a model of the function relationship underli the label. thi model, refer to as a  hypothesi, is usual a comput function that is us to forecast the label of futur observ. the label ar usual binari valu indic the membership of the  observ point in the set that is be learn. howev, we ar not limit to binari valu and, inde, in the demand function we ar studi the label ar real vector. the learn problem ha three major compon:  estim, approxim and complex. the estim problem is concern with the tradeoff between the size of the sampl given to the algorithm and the degre of  confid we have in the forecast it produc. the  approxim problem is concern with the abil of hypothes from a certain class to approxim target function from a possibl differ class. the complex problem is  concern with the comput complex of find a  hypothesi that approxim the target function. a parametr paradigm assum that the underli  function relationship come from a well defin famili, such as the cobb-dougla product function; the system must learn the paramet character thi famili. suppos that a learn algorithm observ a finit set of product data which it assum come from a cobb-dougla  product function and return a hypothesi that is a polynomi of bound degre. the estim problem in thi case would be to assess the sampl size need to obtain a good estim of the coeffici. the approxim problem would be to assess the error sustain from approxim a ration function by a polynomi. the complex problem would be the assess of the time requir to comput the polynomi coeffici. in the probabl approxim correct (pac) paradigm, the learn of a target function is done by a class of  hypothesi function, that doe or doe not includ the  target function itself; it doe not necessit ani parametr assumpt on thi class. it is also assum that the  observ ar gener independ by some distribut on the domain of the relat and that thi distribut is fix. if the class of target function ha finit  "dimension" then a function in the class is character by it valu on a finit number of point. the basic idea is to observ the label of a finit number of point and find a  function from a class of hypothes which tend to agre with thi label. the theori tell us that if the sampl is larg enough then ani function that tend to agre with the  label will, with high probabl, be a good approxim of the target function for futur observ. the prime object of pac theori is to develop the relev notion of dimension and to formal the tradeoff between  dimension, sampl size and the level of confid in the forecast. in the reveal prefer set, our object is to us a set of observ of price and demand to forecast  demand for unobserv price. thu the target function is a map from price to bundl, name f : rd + → rd +. the theori of pac learn for real valu function is concern predominantli with function from rd to r. in thi section we introduc modif to the classic notion of pac learn to vector valu function and us them to prove a lower bound for sampl complex. an upper bound on the sampl complex can also be prove for our definit of fat shatter, but we do not bring it here as the proof is much more tediou and analog to the proof of theorem 4. befor we can proce with the formal definit, we must clarifi what we mean by forecast and tend to agre. in the case of discret learn, we would like to obtain a  function h that with high probabl agre with f. we would then take the probabl pσ(f(x) = h(x)) as the measur of the qualiti of the estim. demand function ar real vector function and we therefor do not expect f and h to agre with high probabl. rather we ar content with have small mean squar error on all coordin. thu, our measur of estim error is given by: erσ(f, h) = z (||f − h||∞)2 dσ. for given observ s = {(p1, x1), . . . , (pn, xn)} we  measur the agreement by the sampl error er(s, h) = x j (||xj − h(pj)||∞)2 . a sampl error minim (sem) algorithm is an  algorithm that find a hypothesi minim er(s, h). in the case of reveal prefer, there is a function that take the sampl error to zero. nevertheless, the upper bound  theorem we us doe not requir the sampl error to be zero. definit 1. a set of demand function c is probabl approxim correct (pac) learnabl by hypothes set h if for ani ε, δ > 0, f ∈ c and distribut σ on the price 39 there exist an algorithm l that for a set of observ of length ml = ml(ε, δ) = poli(1 δ , 1 ε ) find a function h from h such that erσ(f, h) < ε with probabl 1 − δ. there mai be sever learn algorithm for c with differ sampl complex. the minim ml is call the sampl complex of c. note that in the definit there is no mention of the time complex to find h in h and evalu h(p). a set c is effici pac-learnabl if there is a poli(1 δ , 1 ε ) time  algorithm for choos h and evalu h(p). for discret function set, sampl complex bound mai be deriv from the vc-dimens of the set (see [19, 8]). an analog to thi notion of dimens for real function is the fat shatter dimens. we us an adapt of thi notion to real vector valu function set. let Γ ⊂ rd + and let c be a set of real function from Γ to rd +. definit 2. for γ > 0, a set of point p1, . . . , pn ∈ Γ is γ-shatter by a class of real function c if there exist x1, . . . , xn ∈ rd + and parallel affin hyperplan h0, h1 ⊂ rd such that 0 ∈ h− 0 ∩ h+ 1 , dist(h0, h1) > γ and for each b = (b1, . . . , bn) ∈ {0, 1}n there exist a function fb ∈ c such that fb(pi) ∈ xi + h+ 0 if bi = 0 and f(pi) ∈ xi + h− 1 if bi = 1. we defin the γ-fat shatter dimens of c, denot fatc(γ) as the maxim size of a γ-shatter set in Γ. if thi size is unbound then the dimens is infinit. to demonstr the us of the thi notion we us it to deriv a lower bound on the sampl complex. lemma 2. suppos the function {fb : b ∈ {0, 1}n }  wit the shatter of {p1, . . . , pn}. then, for ani x ∈ rd + and label b, b ∈ {0, 1}n such that bi = bi either ||fb(pi) − x||∞ > γ 2d or ||fb (pi) − x||∞ > γ 2d . proof : sinc the max exce the mean, it follow that if fb and fb correspond to label such that bi = bi then ||fb(pi) − fb (pi)||∞ ≥ 1 d ||fb(pi) − fb (pi)||2 > γ d . thi impli that for ani x ∈ rd + either ||fb(pi) − x||∞ > γ 2d or ||fb (pi) − x||∞ > γ 2d ✷ theorem 3. suppos that c is a class of function  map from Γ to rd +. then ani learn algorithm l for c ha sampl complex satisfi ml(ε, δ) ≥ 1 2 fatc(4dε) an analog of thi theorem for real valu function with a tighter bound can be found in [2], thi version will suffic for our need. proof : suppos n = 1 2 fatc(4dε) then there exist a set Γs = {p1, . . . , p2n} that is shatter by c. it suffic to show that at least on distribut requir larg sampl. we construct such a distribut. let σ be the uniform distribut on Γs and cs = {fb : b ∈ {0, 1}2n } be the set of function that wit the shatter of {p1. . . . , pn}. let fb be a function chosen uniformli at random from cs. it follow from lemma 2 (with γ = 2d ) that for ani fix function h the probabl that ||fb(p) − h(p)||∞ > 2ε for p ∈ Γs is at least as high as get head on a fair coin toss. therefor eb(||fb(p) − h(p)||∞) > 2ε. suppos for a sequenc of observ z = ((pi1 , x1), . . . , (pin , xn)) a learn algorithm l find a function h. the  observ abov and fubini impli eb(erσ(h, fb)) > ε.  random on the sampl space we get eb,z(erσ(h, fb)) > ε. thi show eh,z(erσ(h, fb0 )) > ε for some fb0 . w.l.g we mai assum the error is bound (sinc we ar look at what is essenti a finit set) therefor the probabl that erσ(h, fb0 ) > ε cannot be too small, henc fb0 is not  paclearn with a sampl of size n ✷ the follow theorem give an upper bound on the  sampl complex requir for learn a set of function with finit fat shatter dimens. the theorem is prove in [2] for real valu function, the proof for the real vector case is analog and so omit. theorem 4. let c be a set of real-valu function from x to [0, 1] with fatc(γ) < ∞. let a be approxim-sem algorithm for c and defin l(z) = a(z, ε0 6 ) for z ∈ zm and ε0 = 16√ m . then l is a learn algorithm for c with sampl complex given by: ml(ε, δ) = o „ 1 ε2 (ln2 ( 1 ε )fatc(ε) + ln( 1 δ )) « for ani ε, δ > 0. 5. learn from reveal  prefer algorithm 1 is an effici learn algorithm in the sens that it find a hypothesi with sampl error zero in time polynomi in the number of observ. as we have seen in section 4 the number of observ requir to pac learn the demand depend on the fat shatter dimens of the class of demand function which in turn depend on the class of util function thei ar deriv from. we comput the fat shatter dimens for two class of demand. the first is the class of all demand function, we show that thi class ha infinit shatter dimens (we give two proof) and is therefor not pac learnabl. the second class we  consid is the class of demand function deriv from util with bound support and incom-lipschitz. we show that the class ha a finit fat shatter dimens that depend on the support and the incom-lipschitz constant. theorem 5. let c be a set of demand function from rd + to rd + then fatc(γ) = ∞ proof 1: for ε > 0 let pi = 2−i p for i = 1, . . . , n be a set of price vector induc parallel budget set bi and let x1, . . . , xn be the intersect of these hyperplan with an orthogon line pass through the center. let h0 and h1 be hyperplan that ar not parallel to p and let xi ∈ bi ∩ (xi + h+ 0 ) and xi ∈ bi ∩ (xi + h− 1 ) for i = 1 . . . n (see figur 1). for ani label b = (b1, . . . , bn) ∈ {0, 1}n let y = y(b) = (y1, . . . , yn) be a set of demand such that yi = xi if bi = 0 and yi = xi if bi = 1 (we omit an addit index b in y for notat conveni). to show that p1, . . . , pn is shatter it suffic to find for everi b a demand function fb support by concav util such that fb(pi) = yb i . to show that such a function exist it suffic to show that afriat"s condit ar satisfi. sinc yi ar in the budget 40 set yi · 2−i p = 1, therefor pi · (yj − yi) = 2j−i − 1. thi show that pi · (yj − yi) ≤ 0 iff j < i henc there can be no neg cycl and the condit is met. ✷ proof 2: the util function satisfi afriat"s condit in the first proof could be trivial assign the same util to xi as to xi . in fact, pick a util function whose level set ar parallel to the budget constraint. therefor the shatter of the price p1, . . . , pn is the result of indiffer rather than genuin prefer. to avoid thi problem we reprov the theorem by construct util function u such that u(xi) = u(xi ) for all i and therefor a distinct util function is associ with each label. for i = 1, . . . n let pi1, . . . , pid be price vector satisfi the follow condit: 1. the budget set bs i ar support hyperplan of a convex polytop Λi 2. yi is a vertex of Λi 3. ||yj ||1 · ||pi − pi||∞ = o(1) for s = 1, . . . d and j = 1, . . . , n final let yi1, . . . , yid be point on the facet of Λi that intersect yi, such that ||pjr||1 · ||yi − yi||∞ = o(1) for all j, s and r. we call the set of point yi, yi1, . . . , yid the level i demand and pi, pi1, . . . , pid level i price. appli h¨older inequ we get |pir · yj − pi · yj | ≤ |(pir − pi) · yj| + |pir · (yj − yj)| ||pir − pi||∞ · ||yj ||1 + ||yj − yj||∞ · ||pir||1. = o(1) thi show that pir · (yj − yir) = pi · (ys − yi) + o(1) = 2j−i − 1 + o(1) therefor pir · (yj − yir) ≤ 0 iff j < i or i = j. thi impli that if there is a neg cycl then all the point in the cycl must belong to the same level. the point of ani on level lie on the facet of a polytop Λi and the price pi ar support hyperplan of the polytop. thu, the polytop defin a util function for which these demand ar util maxim. the other direct of afriat"s theorem  therefor impli there can be no neg cycl within point on the same level. it follow that there ar no neg cycl for the union of observ from all level henc the sequenc of  observ (y1, p1), (y11, p11), (y12, p12), . . . , (ynd, pnd) is  consist with monoton concav util function maxim and again by afriat"s theorem there exist u support a demand function fb ✷ the proof abov reli on the fact that an agent have high util and margin util for veri larg bundl. in mani case it is reason to assum that the margin for veri larg bundl is veri small, or even that the util or the margin util have compact support. unfortun,  rescal the previou exampl show that even a compact set mai contain a larg shatter set. we notic howev, that in thi case we obtain a util function that yield demand function that ar veri sensit to small price chang. we show that the class of util function that have margin util with compact support and for which the relev  demand function ar incom-lipschitzian ha finit fat  shatter dimens. ✲ ✻ ❅ ❅ ❅ ❅ ❅ ❅ ❅ ❅ ❅ ❅ ❅ ❅ ❅ ❅ ❅ ❅ ❅ ❅ ❅ ❅ ❅ ❅ ❅ ❅ (0,0)               h0               h1r x1 r x1 ❈ ❈ ❜ ❜❜ r x2 r x2 ❚ ❚ ❚ ❚ ❚ ❚ ❚ ❚ ❚ ❚ ❚ ❜ ❜❜ figur 1: util function shatter x1 and x2 theorem 6. let c be a set of l-incom-lipschitz  demand function from ∆d to rd + for some global constant l ∈ r. then fatc(γ) ≤ ( l γ )d proof : let p1, . . . , pn ∈ ∆d be a shatter set with  wit x1, . . . , xn ∈ rd +. w.l.g. xi+h+ 0 ∩xj +h− 0 = ∅  impli xi + h− 1 ∩ xj + h+ 1 = ∅, for a label b = (b1, . . . , bn) ∈ {0, 1}n such that bi = 0 and bj = 1, ||fb(pi) − fb(pj)||∞ > γ henc ||pi − pj||∞ > γ l . a standard pack argument  impli n ≤ (l γ )d ✷ 6. acknowledg the author would like to thank eli shamir, ehud kalai, julio gonz´alez d´ıaz, rosa matzkin, gad allon and adam galambo for help discuss and suggest. 7. refer [1] afriat s. n. (1967) the construct of a util function from expenditur data intern econom review 8, 67-77. [2] anthoni m. and bartlett p. l. (1999) neural network learn: theoret foundat cambridg univers press. [3] blundel r., brown m. and crawford i. (2003) nonparametr engel curv and reveal prefer. econometrica, 71(1):205-240. [4] blundel r. (2005 ) how reveal is reveal prefer? european econom journal 3, 211 - 235. [5] diewert e. (1973) afriat and reveal prefer theori review of econom studi 40, 419 - 426. [6] farka j. (1902) ¨uber die theori der einfachen ungleichungen journal f¨ur die rein und angewandt mathematik 124 1-27 [7] houthakk h. (1950) reveal prefer and the util function economica 17, 159 - 174. [8] kearn m. and vazirani u. (1994) an introduct to comput learn theori the mit press cambridg ma. 41 [9] knoblauch v. (1992) a tight upper bound on the monei metric util function. the american econom review, 82(3):660-663. [10] ma-colel a. (1977) the recover of consum" prefer from market demand. econometrica, 45(6):1409-1430. [11] ma-colel a. (1978) on reveal prefer analysi. the review of econom studi, 45(1):121-131. [12] ma-colel a., whinston m. and green j. r. (1995) microeconom theori oxford univers press. [13] matzkin r. and richter m. (1991) test strictli concav ration. journal of econom theori, 53:287-303. [14] papadimitri c. h. and steiglitz k. (1982) combinatori optim dover public inc. [15] richter m. (1966) reveal prefer theori. econometrica, 34(3):635-645. [16] uzawa h. (1960 ) prefer and ration choic in the theori of consumpt. in k. j. arrow, s. karlin, and p. supp, editor, mathemat model in social scienc stanford univers press, stanford, ca. [17] teo c. p. and vohra r. v. (2003) afriat"s theorem and neg cycl work paper [18] samuelson p. a. (1948) consumpt theori in term of reveal prefer economica 15, 243 - 253. [19] vapnik v. n. (1998) statist learn theori john wilei & son inc. [20] varian h. r. (1982) the non-parametr approach to demand analysi econometrica 50, 945 - 974. [21] varian h. r. (2005) reveal prefer, in michael szenberg editor, samuelson econom and the 21st centuri. [22] ziegler g. m. (1994) lectur on polytop springer. 42 